<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>13.4. lzma — LZMA アルゴリズムを使用した圧縮 &#8212; Python 3.6.1 ドキュメント</title>
    
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.6.1 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="Python 3.6.1 ドキュメント" href="../contents.html" />
    <link rel="up" title="13. データ圧縮とアーカイブ" href="archiving.html" />
    <link rel="next" title="13.5. zipfile — ZIP アーカイブの処理" href="zipfile.html" />
    <link rel="prev" title="13.3. bz2 — bzip2 圧縮のサポート" href="bz2.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <link rel="canonical" href="https://docs.python.jp/3/library/lzma.html" /><script type="text/javascript">
    $(document).ready(function() {
      var base = 'https://docs.python.org/3.6/library/lzma.html';
      $('a.headerlink').each(function() {
        var html = '<a href="' + base + $(this).attr('href') +
                   '" title="原文へのリンク"><small>(原文)</small></a>';
        $(this).after(html);
      })
    });
    </script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <script type="text/javascript" src="../_static/version_switch.js"></script>
    
    
 

  </head>
  <body role="document">  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="zipfile.html" title="13.5. zipfile — ZIP アーカイブの処理"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="bz2.html" title="13.3. bz2 — bzip2 圧縮のサポート"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="version_switcher_placeholder">3.6.1</span>
          <a href="../index.html">ドキュメント</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="archiving.html" accesskey="U">13. データ圧縮とアーカイブ</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-lzma">
<span id="lzma-compression-using-the-lzma-algorithm"></span><h1>13.4. <a class="reference internal" href="#module-lzma" title="lzma: A Python wrapper for the liblzma compression library."><code class="xref py py-mod docutils literal"><span class="pre">lzma</span></code></a> &#8212; LZMA アルゴリズムを使用した圧縮<a class="headerlink" href="#module-lzma" title="このヘッドラインへのパーマリンク">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.3 で追加.</span></p>
</div>
<p><strong>ソースコード:</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.6/Lib/lzma.py">Lib/lzma.py</a></p>
<hr class="docutils" />
<p>このモジュールは LZMA 圧縮アルゴリズムを使用したデータ圧縮および展開のためのクラスや便利な関数を提供しています。また、<strong class="program">xz</strong> ユーティリティを使用した <code class="docutils literal"><span class="pre">.xz</span></code> およびレガシーな <code class="docutils literal"><span class="pre">.lzma</span></code> ファイル形式へのファイルインターフェイスの他、RAW 圧縮ストリームもサポートしています。</p>
<p>このモジュールが提供するインターフェイスは <a class="reference internal" href="bz2.html#module-bz2" title="bz2: Interfaces for bzip2 compression and decompression."><code class="xref py py-mod docutils literal"><span class="pre">bz2</span></code></a> モジュールと非常によく似ています。ただし、<a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> は (<a class="reference internal" href="bz2.html#bz2.BZ2File" title="bz2.BZ2File"><code class="xref py py-class docutils literal"><span class="pre">bz2.BZ2File</span></code></a> と異なり) スレッドセーフではない点に注意してください。単一の <a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> インスタンスを複数スレッドから使用する場合は、ロックで保護する必要があります。</p>
<dl class="exception">
<dt id="lzma.LZMAError">
<em class="property">exception </em><code class="descclassname">lzma.</code><code class="descname">LZMAError</code><a class="headerlink" href="#lzma.LZMAError" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>この例外は圧縮あるいは展開中にエラーが発生した場合、または圧縮/展開状態の初期化中に送出されます。</p>
</dd></dl>

<div class="section" id="reading-and-writing-compressed-files">
<h2>13.4.1. 圧縮ファイルへの読み書き<a class="headerlink" href="#reading-and-writing-compressed-files" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="function">
<dt id="lzma.open">
<code class="descclassname">lzma.</code><code class="descname">open</code><span class="sig-paren">(</span><em>filename</em>, <em>mode=&quot;rb&quot;</em>, <em>*</em>, <em>format=None</em>, <em>check=-1</em>, <em>preset=None</em>, <em>filters=None</em>, <em>encoding=None</em>, <em>errors=None</em>, <em>newline=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.open" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>LZMA 圧縮ファイルをバイナリまたはテキストモードでオープンし、<a class="reference internal" href="../glossary.html#term-file-object"><span class="xref std std-term">ファイルオブジェクト</span></a> を返します。</p>
<p><em>filename</em> 引数には、ファイルをオープンする際には実際のファイル名 (<a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a>、 <a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a>、または <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like</span></a> オブジェクトとして指定します)か、読み込みまたは書き込むためであれば、すでに存在するファイルオブジェクトを指定できます。</p>
<p>引数 <em>mode</em> は、バイナリモードでは <code class="docutils literal"><span class="pre">&quot;r&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;rb&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;w&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;wb&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;x&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;xb&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;a&quot;</span></code>、あるいは <code class="docutils literal"><span class="pre">&quot;ab&quot;</span></code> の、テキストモードでは <code class="docutils literal"><span class="pre">&quot;rt&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;wt&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;xt&quot;</span></code>、あるいは <code class="docutils literal"><span class="pre">&quot;at&quot;</span></code> のいずれかになります。デフォルトは <code class="docutils literal"><span class="pre">&quot;rb&quot;</span></code> です。</p>
<p>読み込み用にファイルをオープンした場合、引数 <em>format</em> および <em>filters</em> は <a class="reference internal" href="#lzma.LZMADecompressor" title="lzma.LZMADecompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMADecompressor</span></code></a> と同じ意味になります。この時、引数 <em>check</em> および <em>preset</em> は使用しないでください。</p>
<p>書き出し用にオープンした場合、引数 <em>format</em>、<em>check</em>、<em>preset</em>、および <em>filters</em> は <a class="reference internal" href="#lzma.LZMACompressor" title="lzma.LZMACompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMACompressor</span></code></a> と同じ意味になります。</p>
<p>バイナリモードでは、この関数は <a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> コンストラクタと等価になります (<code class="docutils literal"><span class="pre">LZMAFile(filename,</span> <span class="pre">mode,</span> <span class="pre">...)</span></code>)。この場合、引数 <em>encoding</em>、<em>errors</em>、および <em>newline</em> を指定しなければなりません。</p>
<p>テキストモードでは、<a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> オブジェクトが生成され、指定したエンコーディング、エラーハンドラの挙動、および改行コードで <a class="reference internal" href="io.html#io.TextIOWrapper" title="io.TextIOWrapper"><code class="xref py py-class docutils literal"><span class="pre">io.TextIOWrapper</span></code></a> にラップされます。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.4 で変更: </span><code class="docutils literal"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal"><span class="pre">&quot;xb&quot;</span></code>, <code class="docutils literal"><span class="pre">&quot;xt&quot;</span></code> モードのサポートが追加されました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.6 で変更: </span><a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> を受け入れるようになりました。</p>
</div>
</dd></dl>

<dl class="class">
<dt id="lzma.LZMAFile">
<em class="property">class </em><code class="descclassname">lzma.</code><code class="descname">LZMAFile</code><span class="sig-paren">(</span><em>filename=None</em>, <em>mode=&quot;r&quot;</em>, <em>*</em>, <em>format=None</em>, <em>check=-1</em>, <em>preset=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMAFile" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>LZMA 圧縮ファイルをバイナリモードで開きます。</p>
<p><a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> はすでにオープンしている <a class="reference internal" href="../glossary.html#term-file-object"><span class="xref std std-term">file object</span></a> をラップ、または名前付きファイルを直接操作できます。引数 <em>filename</em> にはラップするファイルオブジェクトかオープンするファイル名 (<a class="reference internal" href="stdtypes.html#str" title="str"><code class="xref py py-class docutils literal"><span class="pre">str</span></code></a> オブジェクトま、<a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクト、または <a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like</span></a> オブジェクト) を指定します。既存のファイルオブジェクトをラップした場合、<a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> をクローズしてもラップしたファイルはクローズされません。</p>
<p>引数 <em>mode</em> は読み込みモードの <code class="docutils literal"><span class="pre">&quot;r&quot;</span></code> (デフォルト)、上書きモードの <code class="docutils literal"><span class="pre">&quot;w&quot;</span></code>、排他的生成モードの <code class="docutils literal"><span class="pre">&quot;x&quot;</span></code>、あるいは追記モードの <code class="docutils literal"><span class="pre">&quot;a&quot;</span></code> のいずれかを指定できます。これらはそれぞれ <code class="docutils literal"><span class="pre">&quot;rb&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;wb&quot;</span></code>、<code class="docutils literal"><span class="pre">&quot;xb&quot;</span></code>、および <code class="docutils literal"><span class="pre">&quot;ab&quot;</span></code> と等価です。</p>
<p><em>filename</em> が (実際のファイル名でなく) ファイルオブジェクトの場合、<code class="docutils literal"><span class="pre">&quot;w&quot;</span></code> モードはファイルを上書きせず、<code class="docutils literal"><span class="pre">&quot;a&quot;</span></code> と等価になります。</p>
<p>読み込みモードでファイルをオープンした時、入力ファイルは複数に分割された圧縮ストリームを連結したものでもかまいません。これらは透過的に単一論理ストリームとしてデコードされます。</p>
<p>読み込み用にファイルをオープンした場合、引数 <em>format</em> および <em>filters</em> は <a class="reference internal" href="#lzma.LZMADecompressor" title="lzma.LZMADecompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMADecompressor</span></code></a> と同じ意味になります。この時、引数 <em>check</em> および <em>preset</em> は使用しないでください。</p>
<p>書き出し用にオープンした場合、引数 <em>format</em>、<em>check</em>、<em>preset</em>、および <em>filters</em> は <a class="reference internal" href="#lzma.LZMACompressor" title="lzma.LZMACompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMACompressor</span></code></a> と同じ意味になります。</p>
<p><a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> は <a class="reference internal" href="io.html#io.BufferedIOBase" title="io.BufferedIOBase"><code class="xref py py-class docutils literal"><span class="pre">io.BufferedIOBase</span></code></a> で規定されているメンバのうち、<code class="xref py py-meth docutils literal"><span class="pre">detach()</span></code> と <code class="xref py py-meth docutils literal"><span class="pre">truncate()</span></code> を除くすべてをサポートします。イテレーションと <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> 文をサポートしています。</p>
<p>次のメソッドを提供しています:</p>
<dl class="method">
<dt id="lzma.LZMAFile.peek">
<code class="descname">peek</code><span class="sig-paren">(</span><em>size=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMAFile.peek" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ファイル上の現在位置を変更せずにバッファのデータを返します。EOF に達しない限り、少なくとも 1 バイトが返されます。返される正確なバイト数は規定されていません (引数 <em>size</em> は無視されます)。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last"><a class="reference internal" href="#lzma.LZMAFile.peek" title="lzma.LZMAFile.peek"><code class="xref py py-meth docutils literal"><span class="pre">peek()</span></code></a> の呼び出しでは <a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> のファイル位置は変わりませんが、下層のファイルオブジェクトの位置が変わる惧れがあります。(e.g. <a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> を <em>filename</em> にファイルオブジェクトを渡して作成した場合)</p>
</div>
</dd></dl>

<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.4 で変更: </span><code class="docutils literal"><span class="pre">'x'</span></code>, <code class="docutils literal"><span class="pre">'xb'</span></code> モードがサポートが追加されました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.5 で変更: </span><a class="reference internal" href="io.html#io.BufferedIOBase.read" title="io.BufferedIOBase.read"><code class="xref py py-meth docutils literal"><span class="pre">read()</span></code></a> メソッドが <code class="docutils literal"><span class="pre">None</span></code> を引数として受け取るようになりました。</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.6 で変更: </span><a class="reference internal" href="../glossary.html#term-path-like-object"><span class="xref std std-term">path-like object</span></a> を受け入れるようになりました。</p>
</div>
</dd></dl>

</div>
<div class="section" id="compressing-and-decompressing-data-in-memory">
<h2>13.4.2. メモリ上での圧縮と展開<a class="headerlink" href="#compressing-and-decompressing-data-in-memory" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="lzma.LZMACompressor">
<em class="property">class </em><code class="descclassname">lzma.</code><code class="descname">LZMACompressor</code><span class="sig-paren">(</span><em>format=FORMAT_XZ</em>, <em>check=-1</em>, <em>preset=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMACompressor" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>データをインクリメンタルに圧縮する圧縮オブジェクトを作成します。</p>
<p>大量の単一データを圧縮する、より便利な方法については <a class="reference internal" href="#lzma.compress" title="lzma.compress"><code class="xref py py-func docutils literal"><span class="pre">compress()</span></code></a> を参照してください。</p>
<p>引数 <em>format</em> には使用するコンテナフォーマットを指定します。以下の値が指定できます:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">FORMAT_XZ</span></code>: The <code class="docutils literal"><span class="pre">.xz</span></code> コンテナフォーマット。</dt>
<dd><p class="first last">デフォルトのフォーマットです。</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">FORMAT_ALONE</span></code>: レガシーな <code class="docutils literal"><span class="pre">.lzma</span></code> コンテナフォーマット。</dt>
<dd><p class="first last">このフォーマットは <code class="docutils literal"><span class="pre">.xz</span></code> より制限があります &#8211; インテグリティチェックや複数フィルタをサポートしていません。</p>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt><code class="xref py py-const docutils literal"><span class="pre">FORMAT_RAW</span></code>: 特定のコンテナフォーマットを使わない、生のデータストリーム。</dt>
<dd><p class="first last">このフォーマット指定子はインテグリティチェックをサポートしておらず、(圧縮および展開双方のために) 常にカスタムフィルタチェインを指定する必要があります。さらに、この方法で圧縮されたデータは <code class="xref py py-const docutils literal"><span class="pre">FORMAT_AUTO</span></code> を使っても展開できません (<a class="reference internal" href="#lzma.LZMADecompressor" title="lzma.LZMADecompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMADecompressor</span></code></a> を参照)。</p>
</dd>
</dl>
</li>
</ul>
<p>引数 <em>check</em> には圧縮データに組み込むインテグリティチェックのタイプを指定します。このチェックは展開時に使用され、データが破損していないことを保証します。以下の値が指定できます:</p>
<ul class="simple">
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">CHECK_NONE</span></code>: インテグリティチェックなし。<code class="xref py py-const docutils literal"><span class="pre">FORMAT_ALONE</span></code> および <code class="xref py py-const docutils literal"><span class="pre">FORMAT_RAW</span></code> のデフォルト (かつ唯一指定可能な値) です。</p>
</li>
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">CHECK_CRC32</span></code>: 32-bit 巡回冗長検査。</p>
</li>
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">CHECK_CRC64</span></code>: 64-bit 巡回冗長検査。<code class="xref py py-const docutils literal"><span class="pre">FORMAT_XZ</span></code> のデフォルトです。</p>
</li>
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">CHECK_SHA256</span></code>: 256-bit セキュアハッシュアルゴリズム (SHA)。</p>
</li>
</ul>
<p>指定したチェック方法がサポートされていない場合、<a class="reference internal" href="#lzma.LZMAError" title="lzma.LZMAError"><code class="xref py py-class docutils literal"><span class="pre">LZMAError</span></code></a> が送出されます。</p>
<p>圧縮設定はプリセット圧縮レベル (引数 <em>preset</em> で指定) またはカスタムフィルタチェイン (引数 <em>filters</em> で指定) のどちらかを指定します。</p>
<p>引数 <em>preset</em> を指定する場合、<code class="docutils literal"><span class="pre">0</span></code> から <code class="docutils literal"><span class="pre">9</span></code> までの整数値でなければならず、オプションで定数 <code class="xref py py-const docutils literal"><span class="pre">PRESET_EXTREME</span></code> を論理和指定できます。<em>preset</em> も <em>filters</em> も指定されなかった場合、デフォルトの挙動として <code class="xref py py-const docutils literal"><span class="pre">PRESET_DEFAULT</span></code> (プリセットレベル <code class="docutils literal"><span class="pre">6</span></code>) が使用されます。高いプリセット値を指定すると圧縮率が上がりますが、圧縮にかかる時間が長くなります。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">CPU の使用量が多いのに加えて、高いプリセットで圧縮を行うには、メモリをずっと多く必要とします (さらに、生成される出力も展開により多くのメモリを必要とします)。例えば、プリセットが <code class="docutils literal"><span class="pre">9</span></code> の場合、<a class="reference internal" href="#lzma.LZMACompressor" title="lzma.LZMACompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMACompressor</span></code></a> オブジェクトのオーバーヘッドは 800 MiB にまで高くなる場合があります。このため、通常はデフォルトのプリセットを使用するのがよいでしょう。</p>
</div>
<p>引数 <em>filters</em> を指定する場合、フィルタチェイン指定子でなければなりません。詳しくは <a class="reference internal" href="#filter-chain-specs"><span class="std std-ref">カスタムフィルタチェインの指定</span></a> を参照してください。</p>
<dl class="method">
<dt id="lzma.LZMACompressor.compress">
<code class="descname">compress</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMACompressor.compress" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>data</em> (<a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクト) を圧縮し、少なくともその一部が圧縮されたデータを格納する <a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクトを返します。<em>data</em> の一部は、後で <a class="reference internal" href="#lzma.compress" title="lzma.compress"><code class="xref py py-meth docutils literal"><span class="pre">compress()</span></code></a> および <a class="reference internal" href="#lzma.LZMACompressor.flush" title="lzma.LZMACompressor.flush"><code class="xref py py-meth docutils literal"><span class="pre">flush()</span></code></a> の呼び出しに使用するため内部でバッファされている場合があります。返すデータは以前の <a class="reference internal" href="#lzma.compress" title="lzma.compress"><code class="xref py py-meth docutils literal"><span class="pre">compress()</span></code></a> 呼び出しの出力を連結したものです。</p>
</dd></dl>

<dl class="method">
<dt id="lzma.LZMACompressor.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMACompressor.flush" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>圧縮処理を終了し、コンプレッサの内部バッファにあるあらゆるデータを格納する <a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクトを返します。</p>
<p>コンプレッサはこのメソッドが呼び出された後は使用できません。</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="lzma.LZMADecompressor">
<em class="property">class </em><code class="descclassname">lzma.</code><code class="descname">LZMADecompressor</code><span class="sig-paren">(</span><em>format=FORMAT_AUTO</em>, <em>memlimit=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMADecompressor" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>データをインクリメンタルに展開するために使用できる展開オブジェクトを作成します。</p>
<p>圧縮されたストリーム全体を一度に展開にする、より便利な方法については、<a class="reference internal" href="#lzma.decompress" title="lzma.decompress"><code class="xref py py-func docutils literal"><span class="pre">decompress()</span></code></a> を参照してください。</p>
<p>引数 <em>format</em> には使用するコンテナフォーマットを指定します。デフォルトは <code class="xref py py-const docutils literal"><span class="pre">FORMAT_AUTO</span></code> で、<code class="docutils literal"><span class="pre">.xz</span></code> および <code class="docutils literal"><span class="pre">.lzma</span></code> ファイルを展開できます。その他に指定できる値は、<code class="xref py py-const docutils literal"><span class="pre">FORMAT_XZ</span></code>、<code class="xref py py-const docutils literal"><span class="pre">FORMAT_ALONE</span></code>、および <code class="xref py py-const docutils literal"><span class="pre">FORMAT_RAW</span></code> です。</p>
<p>引数 <em>memlimit</em> にはデコンプレッサが使用できるメモリ量をバイトで指定します。この引数を指定した場合、そのメモリ量で展開ができないと <a class="reference internal" href="#lzma.LZMAError" title="lzma.LZMAError"><code class="xref py py-class docutils literal"><span class="pre">LZMAError</span></code></a> を送出します。</p>
<p>引数 <em>filters</em> には展開されるストリームの作成に使用するフィルタチェインを指定します。この引数を使用する際は、引数 <em>format</em> に <code class="xref py py-const docutils literal"><span class="pre">FORMAT_RAW</span></code> を指定しなければなりません。フィルタチェインについての詳細は <a class="reference internal" href="#filter-chain-specs"><span class="std std-ref">カスタムフィルタチェインの指定</span></a> を参照してください。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">このクラスは <a class="reference internal" href="#lzma.decompress" title="lzma.decompress"><code class="xref py py-func docutils literal"><span class="pre">decompress()</span></code></a> および <a class="reference internal" href="#lzma.LZMAFile" title="lzma.LZMAFile"><code class="xref py py-class docutils literal"><span class="pre">LZMAFile</span></code></a> と異なり、複数の圧縮ストリームを含む入力を透過的に扱いません。 <a class="reference internal" href="#lzma.LZMADecompressor" title="lzma.LZMADecompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMADecompressor</span></code></a> で複数ストリーム入力を展開するには、各ストリームごとに新しいデコンプレッサを作成しなければなりません。</p>
</div>
<dl class="method">
<dt id="lzma.LZMADecompressor.decompress">
<code class="descname">decompress</code><span class="sig-paren">(</span><em>data</em>, <em>max_length=-1</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.LZMADecompressor.decompress" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>data</em> (<a class="reference internal" href="../glossary.html#term-bytes-like-object"><span class="xref std std-term">bytes-like object</span></a>) を展開し、未圧縮のデータを bytes で返します。
<em>data</em> の一部は、後で <a class="reference internal" href="#lzma.decompress" title="lzma.decompress"><code class="xref py py-meth docutils literal"><span class="pre">decompress()</span></code></a> の呼び出しに使用するため内部でバッファされている場合があります。
返すデータは以前の <a class="reference internal" href="#lzma.decompress" title="lzma.decompress"><code class="xref py py-meth docutils literal"><span class="pre">decompress()</span></code></a> 呼び出しの出力を全て連結したものです。</p>
<p><em>max_length</em> が非負の場合、最大 <em>max_length</em> バイトの展開データを返します。この制限に達して、出力がさらに生成できる場合、 <a class="reference internal" href="#lzma.LZMADecompressor.needs_input" title="lzma.LZMADecompressor.needs_input"><code class="xref py py-attr docutils literal"><span class="pre">needs_input</span></code></a> が <code class="docutils literal"><span class="pre">False</span></code> に設定されます。この場合、 <a class="reference internal" href="#lzma.LZMADecompressor.decompress" title="lzma.LZMADecompressor.decompress"><code class="xref py py-meth docutils literal"><span class="pre">decompress()</span></code></a> を次に呼び出すと、<em>data</em> を <code class="docutils literal"><span class="pre">b''</span></code> として提供し、出力をさらに取得することができます。</p>
<p>入力データの全てが圧縮され返された (<em>max_length</em> バイトより少ないためか <em>max_length</em> が負のため) 場合、
<a class="reference internal" href="#lzma.LZMADecompressor.needs_input" title="lzma.LZMADecompressor.needs_input"><code class="xref py py-attr docutils literal"><span class="pre">needs_input</span></code></a> 属性は <code class="docutils literal"><span class="pre">True</span></code> になります。</p>
<p>ストリームの終端に到達した後にデータを展開しようとすると <cite>EOFError</cite> が送出されます。
ストリームの終端の後ろの全てのデータは無視され、その部分は <a class="reference internal" href="#lzma.LZMADecompressor.unused_data" title="lzma.LZMADecompressor.unused_data"><code class="xref py py-attr docutils literal"><span class="pre">unused_data</span></code></a> 属性に保存されます。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.5 で変更: </span><code class="docutils literal"><span class="pre">max_length</span></code> パラメータが追加されました。</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="lzma.LZMADecompressor.check">
<code class="descname">check</code><a class="headerlink" href="#lzma.LZMADecompressor.check" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>入力ストリームに使用されるインテグリティチェックの ID です。これは何のインテグリティチェックが使用されているか決定するために十分な入力がデコードされるまでは <code class="xref py py-const docutils literal"><span class="pre">CHECK_UNKNOWN</span></code> になることがあります。</p>
</dd></dl>

<dl class="attribute">
<dt id="lzma.LZMADecompressor.eof">
<code class="descname">eof</code><a class="headerlink" href="#lzma.LZMADecompressor.eof" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ストリーム終端記号に到達した場合 <code class="docutils literal"><span class="pre">True</span></code> を返します。</p>
</dd></dl>

<dl class="attribute">
<dt id="lzma.LZMADecompressor.unused_data">
<code class="descname">unused_data</code><a class="headerlink" href="#lzma.LZMADecompressor.unused_data" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>圧縮ストリームの末尾以降に存在したデータを表します。</p>
<p>ストリームの末尾に達する前は、これは <code class="docutils literal"><span class="pre">b&quot;&quot;</span></code> になります。</p>
</dd></dl>

<dl class="attribute">
<dt id="lzma.LZMADecompressor.needs_input">
<code class="descname">needs_input</code><a class="headerlink" href="#lzma.LZMADecompressor.needs_input" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#lzma.LZMADecompressor.decompress" title="lzma.LZMADecompressor.decompress"><code class="xref py py-meth docutils literal"><span class="pre">decompress()</span></code></a> メソッドが、新しい非圧縮入力を必要とせずにさらに展開データを提供できる場合、 <code class="docutils literal"><span class="pre">False</span></code> です。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.5 で追加.</span></p>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="lzma.compress">
<code class="descclassname">lzma.</code><code class="descname">compress</code><span class="sig-paren">(</span><em>data</em>, <em>format=FORMAT_XZ</em>, <em>check=-1</em>, <em>preset=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.compress" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>data</em> (<a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクト) を圧縮し、圧縮データを <a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクトとして返します。</p>
<p>引数 <em>format</em>、<em>check</em>、<em>preset</em>、および <em>filters</em> についての説明は上記の <a class="reference internal" href="#lzma.LZMACompressor" title="lzma.LZMACompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMACompressor</span></code></a> を参照してください。</p>
</dd></dl>

<dl class="function">
<dt id="lzma.decompress">
<code class="descclassname">lzma.</code><code class="descname">decompress</code><span class="sig-paren">(</span><em>data</em>, <em>format=FORMAT_AUTO</em>, <em>memlimit=None</em>, <em>filters=None</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.decompress" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>data</em> (<a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクト) を展開し、展開データを <a class="reference internal" href="functions.html#bytes" title="bytes"><code class="xref py py-class docutils literal"><span class="pre">bytes</span></code></a> オブジェクトとして返します。</p>
<p><em>data</em> が複数の明確な圧縮ストリームの連結だった場合、すべてのストリームを展開し、結果の連結を返します。</p>
<p>引数 <em>format</em>、<em>memlimit</em>、および <em>filters</em> の説明は、上記 <a class="reference internal" href="#lzma.LZMADecompressor" title="lzma.LZMADecompressor"><code class="xref py py-class docutils literal"><span class="pre">LZMADecompressor</span></code></a> を参照してください。</p>
</dd></dl>

</div>
<div class="section" id="miscellaneous">
<h2>13.4.3. その他<a class="headerlink" href="#miscellaneous" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="function">
<dt id="lzma.is_check_supported">
<code class="descclassname">lzma.</code><code class="descname">is_check_supported</code><span class="sig-paren">(</span><em>check</em><span class="sig-paren">)</span><a class="headerlink" href="#lzma.is_check_supported" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>指定したインテグリティチェックがシステムでサポートされていれば真を返します。</p>
<p><code class="xref py py-const docutils literal"><span class="pre">CHECK_NONE</span></code> および <code class="xref py py-const docutils literal"><span class="pre">CHECK_CRC32</span></code> は常にサポートされています。<code class="xref py py-const docutils literal"><span class="pre">CHECK_CRC64</span></code> および <code class="xref py py-const docutils literal"><span class="pre">CHECK_SHA256</span></code> は <strong class="program">liblzma</strong> が機能制限セットでコンパイルされている場合利用できないことがあります。</p>
</dd></dl>

</div>
<div class="section" id="specifying-custom-filter-chains">
<span id="filter-chain-specs"></span><h2>13.4.4. カスタムフィルタチェインの指定<a class="headerlink" href="#specifying-custom-filter-chains" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>フィルタチェイン指定子は、辞書のシーケンスで、各辞書は ID と単一フィルタのオプションからなります。各辞書はキー <code class="docutils literal"><span class="pre">&quot;id&quot;</span></code> を持たなければならず、フィルタ依存のオプションを指定する追加キーを持つ場合もあります。有効なフィルタ ID は以下のとおりです:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>圧縮フィルタ:</dt>
<dd><ul class="first last">
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">FILTER_LZMA1</span></code> (<code class="xref py py-const docutils literal"><span class="pre">FORMAT_ALONE</span></code> と共に使用)</p>
</li>
<li><p class="first"><code class="xref py py-const docutils literal"><span class="pre">FILTER_LZMA2</span></code> (<code class="xref py py-const docutils literal"><span class="pre">FORMAT_XZ</span></code> および <code class="xref py py-const docutils literal"><span class="pre">FORMAT_RAW</span></code> と共に使用)</p>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>デルタフィルター:</dt>
<dd><ul class="first last">
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_DELTA</span></code></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ブランチコールジャンプ (BCJ) フィルター:</dt>
<dd><ul class="first last">
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_X86</span></code></li>
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_IA64</span></code></li>
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_ARM</span></code></li>
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_ARMTHUMB</span></code></li>
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_POWERPC</span></code></li>
<li><code class="xref py py-const docutils literal"><span class="pre">FILTER_SPARC</span></code></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>一つのフィルタチェインは 4 個までのフィルタを定義することができ、空にはできません。チェインの最後は圧縮フィルタでなくてはならず、その他のフィルタはデルタまたは BCJ フィルタでなければなりません。</p>
<p>圧縮フィルタは以下のオプション (追加エントリとしてフィルタを表す辞書に指定) をサポートしています:</p>
<blockquote>
<div><ul class="simple">
<li><p class="first"><code class="docutils literal"><span class="pre">preset</span></code>: 明示されていないオプションのデフォルト値のソースとして使用する圧縮プリセット。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">dict_size</span></code>: 辞書のサイズのバイト数。これは、 4 KiB から 1.5 GiB の間にしてください (両端を含みます)。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">lc</span></code>: リテラルコンテキストビットの数。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">lp</span></code>: リテラル位置ビットの数。<code class="docutils literal"><span class="pre">lc</span> <span class="pre">+</span> <span class="pre">lp</span></code> で最大 4 までです。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">pb</span></code>: 位置ビットの数。最大で 4 までです。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">mode</span></code>: <code class="xref py py-const docutils literal"><span class="pre">MODE_FAST</span></code> または <code class="xref py py-const docutils literal"><span class="pre">MODE_NORMAL</span></code>。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">nice_len</span></code>: マッチに &#8220;良い&#8221; とみなす長さ。273 以下でなければなりません。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">mf</span></code>: 使用するマッチファインダ &#8211; <code class="xref py py-const docutils literal"><span class="pre">MF_HC3</span></code>、<code class="xref py py-const docutils literal"><span class="pre">MF_HC4</span></code>、<code class="xref py py-const docutils literal"><span class="pre">MF_BT2</span></code>、<code class="xref py py-const docutils literal"><span class="pre">MF_BT3</span></code>、または <code class="xref py py-const docutils literal"><span class="pre">MF_BT4</span></code>。</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">depth</span></code>: マッチファインダが使用する検索の最大深度。0 (デフォルト) では他のフィルタオプションをベースに自動選択します。</p>
</li>
</ul>
</div></blockquote>
<p>デルタフィルターは、バイト間の差異を保存し、特定の状況で、コンプレッサーに対してさらに反復的な入力を生成します。
デルタフィルターは、1 つのオプション <code class="docutils literal"><span class="pre">dist</span></code> のみをサポートします。
これは差し引くバイトどうしの距離を示します。
デフォルトは 1 で、隣接するバイトの差異を扱います。</p>
<p>The BCJ filters are intended to be applied to machine code. They convert
relative branches, calls and jumps in the code to use absolute addressing, with
the aim of increasing the redundancy that can be exploited by the compressor.
These filters support one option, <code class="docutils literal"><span class="pre">start_offset</span></code>. This specifies the address
that should be mapped to the beginning of the input data. The default is 0.</p>
</div>
<div class="section" id="examples">
<h2>13.4.5. 使用例<a class="headerlink" href="#examples" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>圧縮ファイルからの読み込み:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file.xz&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">file_content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>圧縮ファイルの作成:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Insert Data Here&quot;</span>
<span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file.xz&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>メモリ上でデータを圧縮:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="n">data_in</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;Insert Data Here&quot;</span>
<span class="n">data_out</span> <span class="o">=</span> <span class="n">lzma</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="n">data_in</span><span class="p">)</span>
</pre></div>
</div>
<p>逐次圧縮:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="n">lzc</span> <span class="o">=</span> <span class="n">lzma</span><span class="o">.</span><span class="n">LZMACompressor</span><span class="p">()</span>
<span class="n">out1</span> <span class="o">=</span> <span class="n">lzc</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Some data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">out2</span> <span class="o">=</span> <span class="n">lzc</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Another piece of data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">out3</span> <span class="o">=</span> <span class="n">lzc</span><span class="o">.</span><span class="n">compress</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Even more data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">out4</span> <span class="o">=</span> <span class="n">lzc</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="c1"># Concatenate all the partial results:</span>
<span class="n">result</span> <span class="o">=</span> <span class="sa">b</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">,</span> <span class="n">out3</span><span class="p">,</span> <span class="n">out4</span><span class="p">])</span>
</pre></div>
</div>
<p>すでにオープンしているファイルへの圧縮データの書き出し:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;file.xz&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;This data will not be compressed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">lzf</span><span class="p">:</span>
        <span class="n">lzf</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;This *will* be compressed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;Not compressed</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>カスタムフィルタチェインを使った圧縮ファイルの作成:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lzma</span>
<span class="n">my_filters</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">lzma</span><span class="o">.</span><span class="n">FILTER_DELTA</span><span class="p">,</span> <span class="s2">&quot;dist&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span>
    <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="n">lzma</span><span class="o">.</span><span class="n">FILTER_LZMA2</span><span class="p">,</span> <span class="s2">&quot;preset&quot;</span><span class="p">:</span> <span class="mi">7</span> <span class="o">|</span> <span class="n">lzma</span><span class="o">.</span><span class="n">PRESET_EXTREME</span><span class="p">},</span>
<span class="p">]</span>
<span class="k">with</span> <span class="n">lzma</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;file.xz&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">filters</span><span class="o">=</span><span class="n">my_filters</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;blah blah blah&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">13.4. <code class="docutils literal"><span class="pre">lzma</span></code> &#8212; LZMA アルゴリズムを使用した圧縮</a><ul>
<li><a class="reference internal" href="#reading-and-writing-compressed-files">13.4.1. 圧縮ファイルへの読み書き</a></li>
<li><a class="reference internal" href="#compressing-and-decompressing-data-in-memory">13.4.2. メモリ上での圧縮と展開</a></li>
<li><a class="reference internal" href="#miscellaneous">13.4.3. その他</a></li>
<li><a class="reference internal" href="#specifying-custom-filter-chains">13.4.4. カスタムフィルタチェインの指定</a></li>
<li><a class="reference internal" href="#examples">13.4.5. 使用例</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="bz2.html"
                        title="前の章へ">13.3. <code class="docutils literal"><span class="pre">bz2</span></code> &#8212; <strong class="program">bzip2</strong> 圧縮のサポート</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="zipfile.html"
                        title="次の章へ">13.5. <code class="docutils literal"><span class="pre">zipfile</span></code> &#8212; ZIP アーカイブの処理</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.6/Doc/library/lzma.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="zipfile.html" title="13.5. zipfile — ZIP アーカイブの処理"
             >次へ</a> |</li>
        <li class="right" >
          <a href="bz2.html" title="13.3. bz2 — bzip2 圧縮のサポート"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="version_switcher_placeholder">3.6.1</span>
          <a href="../index.html">ドキュメント</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="archiving.html" >13. データ圧縮とアーカイブ</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2017, Python Software Foundation.
    <br />
    Python Software Foundation は非営利団体です。
    <a href="https://www.python.org/psf/donations/">寄付</a>
    <br />
    最終更新日時: 7月 23, 2017
    <a href="../bugs.html">バグを見つけたら</a>?
    <br />
    このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.4.9 を使って作成されました。
    </div>

  </body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>19.4. mailbox — 様々な形式のメールボックス操作 &#8212; Python 3.6.4 ドキュメント</title>
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.6.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/translations.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Python 3.6.4 ドキュメント 内を検索"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="検索" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="19.5. mimetypes — ファイル名を MIME 型へマップする" href="mimetypes.html" />
    <link rel="prev" title="19.3. mailcap — mailcap ファイルの操作" href="mailcap.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/py.png" />
    <link rel="canonical" href="https://docs.python.jp/3/library/mailbox.html" /><script type="text/javascript">
    $(document).ready(function() {
      var base = 'https://docs.python.org/3.6/library/mailbox.html';
      $('a.headerlink').each(function() {
        var html = '<a href="' + base + $(this).attr('href') +
                   '" title="原文へのリンク"><small>(原文)</small></a>';
        $(this).after(html);
      })
    });
    </script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../_static/version_switch.js"></script>
    
    
 

  </head>
  <body>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="mimetypes.html" title="19.5. mimetypes — ファイル名を MIME 型へマップする"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="mailcap.html" title="19.3. mailcap — mailcap ファイルの操作"
             accesskey="P">前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="version_switcher_placeholder">3.6.4</span>
          <a href="../index.html">ドキュメント</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" accesskey="U">19. インターネット上のデータの操作</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-mailbox">
<span id="mailbox-manipulate-mailboxes-in-various-formats"></span><h1>19.4. <a class="reference internal" href="#module-mailbox" title="mailbox: Manipulate mailboxes in various formats"><code class="xref py py-mod docutils literal"><span class="pre">mailbox</span></code></a> — 様々な形式のメールボックス操作<a class="headerlink" href="#module-mailbox" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p><strong>ソースコード:</strong> <a class="reference external" href="https://github.com/python/cpython/tree/3.6/Lib/mailbox.py">Lib/mailbox.py</a></p>
<hr class="docutils" />
<p>このモジュールでは二つのクラス <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> および <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> をディスク上のメールボックスとそこに収められたメッセージへのアクセスと操作のために定義しています。 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> は辞書のようなキーからメッセージへの対応付けを提供しています。 <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> は <a class="reference internal" href="email.message.html#module-email.message" title="email.message: The base class representing email messages."><code class="xref py py-mod docutils literal"><span class="pre">email.message</span></code></a> モジュールの <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> を拡張して形式ごとの状態と振る舞いを追加しています。サポートされるメールボックスの形式は Maildir, mbox, MH, Babyl, MMDF です。</p>
<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference internal" href="email.html#module-email" title="email: Package supporting the parsing, manipulating, and generating email messages."><code class="xref py py-mod docutils literal"><span class="pre">email</span></code></a> モジュール</dt>
<dd>メッセージの表現と操作。</dd>
</dl>
</div>
<div class="section" id="mailbox-objects">
<span id="id1"></span><h2>19.4.1. <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> オブジェクト<a class="headerlink" href="#mailbox-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="mailbox.Mailbox">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">Mailbox</code><a class="headerlink" href="#mailbox.Mailbox" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックス。内容を確認したり変更したりできます。</p>
<p><a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> 自体はインタフェースを定義し形式ごとのサブクラスに継承されるように意図されたもので、インスタンス化されることは想定されていません。インスタンス化したいならばサブクラスを代わりに使うべきです。</p>
<p><a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のインタフェースは辞書風で、小さなキーがメッセージに対応します。キーは対象となる <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスが発行するもので、そのインスタンスに対してのみ意味を持ちます。一つのキーは一つのメッセージにひも付けられ、その対応はメッセージが他のメッセージで置き換えられるような更新をされたあとも続きます。</p>
<p>メッセージを <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスに追加するには集合風のメソッド <a class="reference internal" href="#mailbox.Mailbox.add" title="mailbox.Mailbox.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a> を使います。また削除は <code class="docutils literal"><span class="pre">del</span></code> 文または集合風の <a class="reference internal" href="#mailbox.Mailbox.remove" title="mailbox.Mailbox.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a> や <a class="reference internal" href="#mailbox.Mailbox.discard" title="mailbox.Mailbox.discard"><code class="xref py py-meth docutils literal"><span class="pre">discard()</span></code></a> を使って行ないます。</p>
<p><a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インタフェースのセマンティクスと辞書のそれとは注意すべき違いがあります。メッセージは、要求されるたびに新しい表現(典型的には <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンス)が現在のメールボックスの状態に基づいて生成されます。同様に、メッセージが <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスに追加される時も、渡されたメッセージ表現の内容がコピーされます。どちらの場合も <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスにメッセージ表現への参照は保たれません。</p>
<p>デフォルトの <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> イテレータはメッセージ表現ごとに繰り返すもので、辞書のイテレータのようにキーごとの繰り返しではありません。さらに、繰り返し中のメールボックスを変更することは安全であり整合的に定義されています。イテレータが作られた後にメールボックスに追加されたメッセージはそのイテレータからは見えません。そのイテレータが yield するまえにメールボックスから削除されたメッセージは黙ってスキップされますが、イテレータからのキーを使ったときにはそのキーに対応するメッセージが削除されているならば <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> を受け取ることになります。</p>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">十分な注意を、何か他のプロセスによっても同時に変更される可能性のあるメールボックスを更新する時は、払わなければなりません。そのようなタスクをこなすのに最も安全なメールボックス形式は Maildir で、 mbox のような単一ファイルの形式を並行した書き込みに利用するのは避けるように努力しましょう。メールボックスを更新する場面では、 <em>必ず</em> <a class="reference internal" href="#mailbox.Mailbox.lock" title="mailbox.Mailbox.lock"><code class="xref py py-meth docutils literal"><span class="pre">lock()</span></code></a> と <a class="reference internal" href="#mailbox.Mailbox.unlock" title="mailbox.Mailbox.unlock"><code class="xref py py-meth docutils literal"><span class="pre">unlock()</span></code></a> メソッドを、ファイル内のメッセージを読んだり書き込んだり削除したりといった操作をする <em>前</em> に、呼び出してロックします。メールボックスをロックし損なうと、メッセージを失ったりメールボックス全体をぐちゃぐちゃにしたりする羽目に陥ります。</p>
</div>
<p><a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスには次のメソッドがあります:</p>
<dl class="method">
<dt id="mailbox.Mailbox.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.add" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスに <em>message</em> を追加し、それに割り当てられたキーを返します。</p>
<p>引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンス、 <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">email.message.Message</span></code></a> インスタンス、文字列、バイト文字列、ファイル風オブジェクト (バイナリモードで開かれていなければなりません) を使えます。 <em>message</em> が適切な形式に特化した <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンス (例えばメールボックスが <a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a> インスタンスのときの <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンス) であれば、形式ごとの情報が利用されます。そうでなければ、形式ごとに必要な情報は適当なデフォルトが使われます。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.2 で変更: </span>バイナリ入力のサポートが追加されました。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.remove" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.__delitem__">
<code class="descname">__delitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__delitem__" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.discard">
<code class="descname">discard</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.discard" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスから <em>key</em> に対応するメッセージを削除します。</p>
<p>対応するメッセージが無い場合、メソッドが <a class="reference internal" href="#mailbox.Mailbox.remove" title="mailbox.Mailbox.remove"><code class="xref py py-meth docutils literal"><span class="pre">remove()</span></code></a> または <a class="reference internal" href="#mailbox.Mailbox.__delitem__" title="mailbox.Mailbox.__delitem__"><code class="xref py py-meth docutils literal"><span class="pre">__delitem__()</span></code></a> として呼び出されている時は <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外が送出されます。しかし、 <a class="reference internal" href="#mailbox.Mailbox.discard" title="mailbox.Mailbox.discard"><code class="xref py py-meth docutils literal"><span class="pre">discard()</span></code></a> として呼び出されている場合は例外は発生しません。基づいているメールボックス形式が別のプロセスからの平行した変更をサポートしているならば、この <a class="reference internal" href="#mailbox.Mailbox.discard" title="mailbox.Mailbox.discard"><code class="xref py py-meth docutils literal"><span class="pre">discard()</span></code></a> の振る舞いの方が好まれるかもしれません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.__setitem__">
<code class="descname">__setitem__</code><span class="sig-paren">(</span><em>key</em>, <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__setitem__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージを <em>message</em> で置き換えます。 <em>key</em> に対応しているメッセージが既に無くなっている場合 <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外が送出されます。</p>
<p><a class="reference internal" href="#mailbox.Mailbox.add" title="mailbox.Mailbox.add"><code class="xref py py-meth docutils literal"><span class="pre">add()</span></code></a> と同様に、引数の <em>message</em> には <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンス、 <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">email.message.Message</span></code></a> インスタンス、文字列、バイト文字列、ファイル風オブジェクト (バイナリモードで開かれていなければなりません) を使えます。 <em>message</em> が適切な形式に特化した <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンス (例えばメールボックスが <a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a> インスタンスのときの <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンス) であれば、形式ごとの情報が利用されます。そうでなければ、現在 <em>key</em> に対応するメッセージの形式ごとの情報が変更されずに残ります。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.iterkeys">
<code class="descname">iterkeys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.iterkeys" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.keys" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.Mailbox.iterkeys" title="mailbox.Mailbox.iterkeys"><code class="xref py py-meth docutils literal"><span class="pre">iterkeys()</span></code></a> として呼び出されると全てのキーについてのイテレータを返しますが、 <a class="reference internal" href="#mailbox.Mailbox.keys" title="mailbox.Mailbox.keys"><code class="xref py py-meth docutils literal"><span class="pre">keys()</span></code></a> として呼び出されるとキーのリストを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.itervalues">
<code class="descname">itervalues</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.itervalues" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.__iter__">
<code class="descname">__iter__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__iter__" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.values">
<code class="descname">values</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.values" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.Mailbox.itervalues" title="mailbox.Mailbox.itervalues"><code class="xref py py-meth docutils literal"><span class="pre">itervalues()</span></code></a> または <a class="reference internal" href="#mailbox.Mailbox.__iter__" title="mailbox.Mailbox.__iter__"><code class="xref py py-meth docutils literal"><span class="pre">__iter__()</span></code></a> として呼び出されると全てのメッセージの表現についてのイテレータを返しますが、 <a class="reference internal" href="#mailbox.Mailbox.values" title="mailbox.Mailbox.values"><code class="xref py py-meth docutils literal"><span class="pre">values()</span></code></a> として呼び出されるとその表現のリストを返します。メッセージは適切な形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして表現されるのが普通ですが、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスが初期化されるときに指定すればお好みのメッセージファクトリを使うこともできます。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last"><a class="reference internal" href="#mailbox.Mailbox.__iter__" title="mailbox.Mailbox.__iter__"><code class="xref py py-meth docutils literal"><span class="pre">__iter__()</span></code></a> は辞書のそれのようにキーについてのイテレータではありません。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.iteritems">
<code class="descname">iteritems</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.iteritems" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.items">
<code class="descname">items</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.items" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>(<em>key</em>, <em>message</em>) ペア、ただし <em>key</em> はキーで <em>message</em> はメッセージ表現、のイテレータ(<a class="reference internal" href="#mailbox.Mailbox.iteritems" title="mailbox.Mailbox.iteritems"><code class="xref py py-meth docutils literal"><span class="pre">iteritems()</span></code></a> として呼び出された場合)、またはリスト(<a class="reference internal" href="#mailbox.Mailbox.items" title="mailbox.Mailbox.items"><code class="xref py py-meth docutils literal"><span class="pre">items()</span></code></a> として呼び出された場合)を返します。メッセージは適切な形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして表現されるのが普通ですが、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスが初期化されるときに指定すればお好みのメッセージファクトリを使うこともできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.get">
<code class="descname">get</code><span class="sig-paren">(</span><em>key</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.get" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Mailbox.__getitem__">
<code class="descname">__getitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__getitem__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージの表現を返します。対応するメッセージが存在しない場合、 <a class="reference internal" href="#mailbox.Mailbox.get" title="mailbox.Mailbox.get"><code class="xref py py-meth docutils literal"><span class="pre">get()</span></code></a> として呼び出されたなら <em>default</em> を返しますが、 <a class="reference internal" href="#mailbox.Mailbox.__getitem__" title="mailbox.Mailbox.__getitem__"><code class="xref py py-meth docutils literal"><span class="pre">__getitem__()</span></code></a> として呼び出されたなら <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外が送出されます。メッセージは適切な形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして表現されるのが普通ですが、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> スタンスが初期化されるときに指定すればお好みのメッセージファクトリを使うこともできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.get_message">
<code class="descname">get_message</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.get_message" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージの表現を形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして返します。もし対応するメッセージが存在しなければ <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外が送出されます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.get_bytes">
<code class="descname">get_bytes</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.get_bytes" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージのバイト列を返すか、そのようなメッセージが存在しない場合は <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外を送出します。</p>
<div class="versionadded">
<p><span class="versionmodified">バージョン 3.2 で追加.</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.get_string">
<code class="descname">get_string</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.get_string" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージの文字列表現を返すか、そのようなメッセージが存在しない場合は <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外を送出します。このメッセージは <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">email.message.Message</span></code></a> を通して処理されて7ビットクリーンな表現へ変換されます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージの表現をファイル風表現として返します。もし対応するメッセージが存在しなければ <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外が送出されます。ファイル風オブジェクトはバイナリモードで開かれているように振る舞います。このファイルは必要がなくなったら閉じなければなりません。</p>
<div class="versionchanged">
<p><span class="versionmodified">バージョン 3.2 で変更: </span>ファイルオブジェクトは実際はバイナリファイルです; 以前は誤ってテキストモードで返されていました。 また、現在ファイル風オブジェクトはコンテキストマネージャプロトコルをサポートしています: <a class="reference internal" href="../reference/compound_stmts.html#with"><code class="xref std std-keyword docutils literal"><span class="pre">with</span></code></a> 文を用いることで自動的にファイルを閉じることができます。</p>
</div>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">他の表現方法とは違い、ファイル風オブジェクトはそれを作り出した <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスやそれが基づいているメールボックスと独立である必要がありません。より詳細な説明は各サブクラスごとにあります。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.__contains__">
<code class="descname">__contains__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__contains__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> がメッセージに対応していれば <code class="docutils literal"><span class="pre">True</span></code> を、そうでなければ <code class="docutils literal"><span class="pre">False</span></code> を返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.__len__">
<code class="descname">__len__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.__len__" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックス中のメッセージ数を返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.clear" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスから全てのメッセージを削除します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.pop">
<code class="descname">pop</code><span class="sig-paren">(</span><em>key</em>, <em>default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.pop" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>key</em> に対応するメッセージの表現を返します。メッセージは適切な形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして表現されるのが普通ですが、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスが初期化されるときに指定すればお好みのメッセージファクトリを使うこともできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.popitem">
<code class="descname">popitem</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.popitem" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>任意に選んだ (<em>key</em>, <em>message</em>) ペアを返します。ただしここで <em>key</em> はキーで <em>message</em> はメッセージ表現です。もしメールボックスが空ならば、 <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> 例外を送出します。メッセージは適切な形式ごとの <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> サブクラスのインスタンスとして表現されるのが普通ですが、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスが初期化されるときに指定すればお好みのメッセージファクトリを使うこともできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.update" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>引数 <em>arg</em> は <em>key</em> から <em>message</em> へのマッピングまたは (<em>key</em>, <em>message</em>) ペアのイテレート可能オブジェクトでなければなりません。メールボックスは、各 <em>key</em> と <em>message</em> のペアについて <a class="reference internal" href="#mailbox.Mailbox.__setitem__" title="mailbox.Mailbox.__setitem__"><code class="xref py py-meth docutils literal"><span class="pre">__setitem__()</span></code></a> を使ったかのように <em>key</em> に対応するメッセージが <em>message</em> になるように更新されます。 <a class="reference internal" href="#mailbox.Mailbox.__setitem__" title="mailbox.Mailbox.__setitem__"><code class="xref py py-meth docutils literal"><span class="pre">__setitem__()</span></code></a> と同様に、 <em>key</em> は既存のメールボックス中のメッセージに対応しているものでなければならず、そうでなければ <a class="reference internal" href="exceptions.html#KeyError" title="KeyError"><code class="xref py py-exc docutils literal"><span class="pre">KeyError</span></code></a> が送出されます。ですから、一般的には <em>arg</em> に <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスを渡すのは間違いです。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">辞書と違い、キーワード引数はサポートされていません。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.flush" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>保留されている変更をファイルシステムに書き込みます。 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラスによっては変更はいつも直ちにファイルに書き込まれ <a class="reference internal" href="#mailbox.Mailbox.flush" title="mailbox.Mailbox.flush"><code class="xref py py-meth docutils literal"><span class="pre">flush()</span></code></a> は何もしないということもありますが、それでもこのメソッドを呼ぶように習慣付けておきましょう。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.lock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスの排他的アドバイザリロックを取得し、他のプロセスが変更しないようにします。ロックが取得できない場合 <a class="reference internal" href="#mailbox.ExternalClashError" title="mailbox.ExternalClashError"><code class="xref py py-exc docutils literal"><span class="pre">ExternalClashError</span></code></a> が送出されます。ロック機構はメールボックス形式によって変わります。メールボックスの内容に変更を加えるときは <em>いつも</em> ロックを掛けるべきです。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスのロックが存在する場合は解放します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Mailbox.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Mailbox.close" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスをフラッシュし、必要ならばアンロックし、開いているファイルを閉じます。 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> サブクラスによっては何もしないこともあります。</p>
</dd></dl>

</dd></dl>

<div class="section" id="maildir">
<span id="mailbox-maildir"></span><h3>19.4.1.1. <a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a><a class="headerlink" href="#maildir" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.Maildir">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">Maildir</code><span class="sig-paren">(</span><em>dirname</em>, <em>factory=None</em>, <em>create=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Maildir 形式のメールボックスのための <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラス。パラメータ <em>factory</em> は呼び出し可能オブジェクトで (バイナリモードで開かれているかのように振る舞う)ファイル風メッセージ表現を受け付けて好みの表現を返すものです。 <em>factory</em> が <code class="docutils literal"><span class="pre">None</span></code> ならば、 <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> がデフォルトのメッセージ表現として使われます。 <em>create</em> が <code class="docutils literal"><span class="pre">True</span></code> ならばメールボックスが存在しないときには作成します。</p>
<p><em>path</em> ではなく <em>dirname</em> と命名される歴史的な理由のためです。</p>
<p>Maildir はディレクトリ型のメールボックス形式でメール転送エージェント qmail 用に発明され、現在では多くの他のプログラムでもサポートされているものです。Maildir メールボックス中のメッセージは共通のディレクトリ構造の下で個別のファイルに保存されます。このデザインにより、Maildir メールボックスは複数の無関係のプログラムからデータを失うことなくアクセスしたり変更したりできます。そのためロックは不要です。</p>
<p>Maildir メールボックスには三つのサブディレクトリ <code class="file docutils literal"><span class="pre">tmp</span></code>, <code class="file docutils literal"><span class="pre">new</span></code>, <code class="file docutils literal"><span class="pre">cur</span></code> があります。メッセージはまず <code class="file docutils literal"><span class="pre">tmp</span></code> サブディレクトリに瞬間的に作られた後、 <code class="file docutils literal"><span class="pre">new</span></code> サブディレクトリに移動されて配送を完了します。メールユーザエージェントが引き続いて <code class="file docutils literal"><span class="pre">cur</span></code> サブディレクトリにメッセージを移動しメッセージの状態についての情報をファイル名に追加される特別な &quot;info&quot; セクションに保存することができます。</p>
<p>Courier メール転送エージェントによって導入されたスタイルのフォルダもサポートされます。主たるメールボックスのサブディレクトリは <code class="docutils literal"><span class="pre">'.'</span></code> がファイル名の先頭であればフォルダと見なされます。フォルダ名は <a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> によって先頭の <code class="docutils literal"><span class="pre">'.'</span></code> を除いて表現されます。各フォルダはまた Maildir メールボックスですがさらにフォルダを含むことはできません。その代わり、論理的包含関係は例えば &quot;Archived.2005.07&quot; のような <code class="docutils literal"><span class="pre">'.'</span></code> を使ったレベル分けで表わされます。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p>本来の Maildir 仕様ではある種のメッセージのファイル名にコロン (<code class="docutils literal"><span class="pre">':'</span></code>) を使う必要があります。しかしながら、オペレーティングシステムによってはこの文字をファイル名に含めることができないことがあります。そういった環境で Maildir のような形式を使いたい場合、代わりに使われる文字を指定する必要があります。感嘆符 (<code class="docutils literal"><span class="pre">'!'</span></code>) を使うのが一般的な選択です。以下の例を見てください:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mailbox</span>
<span class="n">mailbox</span><span class="o">.</span><span class="n">Maildir</span><span class="o">.</span><span class="n">colon</span> <span class="o">=</span> <span class="s1">&#39;!&#39;</span>
</pre></div>
</div>
<p class="last"><code class="xref py py-attr docutils literal"><span class="pre">colon</span></code> 属性はインスタンスごとにセットしても構いません。</p>
</div>
<p><a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> インスタンスには <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> の全てのメソッドに加え以下のメソッドもあります:</p>
<dl class="method">
<dt id="mailbox.Maildir.list_folders">
<code class="descname">list_folders</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.list_folders" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>全てのフォルダ名のリストを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.get_folder">
<code class="descname">get_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.get_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>名前が <em>folder</em> であるフォルダを表わす <a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> インスタンスを返します。そのようなフォルダが存在しなければ <a class="reference internal" href="#mailbox.NoSuchMailboxError" title="mailbox.NoSuchMailboxError"><code class="xref py py-exc docutils literal"><span class="pre">NoSuchMailboxError</span></code></a> 例外が送出されます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.add_folder">
<code class="descname">add_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.add_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>名前が <em>folder</em> であるフォルダを作り、それを表わす <a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> インスタンスを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.remove_folder">
<code class="descname">remove_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.remove_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>名前が <em>folder</em> であるフォルダを削除します。もしフォルダに一つでもメッセージが含まれていれば <a class="reference internal" href="#mailbox.NotEmptyError" title="mailbox.NotEmptyError"><code class="xref py py-exc docutils literal"><span class="pre">NotEmptyError</span></code></a> 例外が送出されフォルダは削除されません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.clean">
<code class="descname">clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.clean" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>過去36時間以内にアクセスされなかったメールボックス内の一時ファイルを削除します。Maildir 仕様はメールを読むプログラムはときどきこの作業をすべきだとしています。</p>
</dd></dl>

<p><a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> で実装された <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のいくつかのメソッドには特別な注意が必要です:</p>
<dl class="method">
<dt id="mailbox.Maildir.add">
<code class="descname">add</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.add" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Maildir.__setitem__">
<code class="descname">__setitem__</code><span class="sig-paren">(</span><em>key</em>, <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.__setitem__" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Maildir.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.update" title="この定義へのパーマリンク">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">これらのメソッドは一意的なファイル名をプロセスIDに基づいて生成します。複数のスレッドを使う場合は、同じメールボックスを同時に操作しないようにスレッド間で調整しておかないと検知されない名前の衝突が起こりメールボックスを壊すかもしれません。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.flush" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Maildir メールボックスへの変更は即時に適用されるので、このメソッドは何もしません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.lock" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Maildir.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Maildir メールボックスはロックをサポート(または要求)しないので、このメソッドは何もしません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.close" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.Maildir" title="mailbox.Maildir"><code class="xref py py-class docutils literal"><span class="pre">Maildir</span></code></a> インスタンスは開いたファイルを保持しませんしメールボックスはロックをサポートしませんので、このメソッドは何もしません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Maildir.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Maildir.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ホストのプラットフォームによっては、返されたファイルが開いている間、元になったメッセージを変更したり削除したりできない場合があります。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="http://www.qmail.org/man/man5/maildir.html">qmail の maildir マニュアルページ</a></dt>
<dd>Maildir 形式のオリジナルの仕様。</dd>
<dt><a class="reference external" href="https://cr.yp.to/proto/maildir.html">Using maildir format</a></dt>
<dd>Maildir 形式の発明者による注意書き。更新された名前生成規則と &quot;info&quot; の解釈についても含まれます。</dd>
<dt><a class="reference external" href="http://www.courier-mta.org/maildir.html">Courier の maildir マニュアルページ</a></dt>
<dd>Maildir 形式のもう一つの仕様。フォルダをサポートする一般的な拡張について記述されています。</dd>
</dl>
</div>
</div>
<div class="section" id="mbox">
<span id="mailbox-mbox"></span><h3>19.4.1.2. <a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a><a class="headerlink" href="#mbox" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.mbox">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">mbox</code><span class="sig-paren">(</span><em>path</em>, <em>factory=None</em>, <em>create=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mbox" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>mbox 形式のメールボックスのための <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラス。パラメータ <em>factory</em> は呼び出し可能オブジェクトで (バイナリモードで開かれているかのように振る舞う)ファイル風メッセージ表現を受け付けて好みの表現を返すものです。 <em>factory</em> が <code class="docutils literal"><span class="pre">None</span></code> ならば、 <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> がデフォルトのメッセージ表現として使われます。 <em>create</em> が <code class="docutils literal"><span class="pre">True</span></code> ならばメールボックスが存在しないときには作成します。</p>
<p>mbox 形式は Unixシステム上でメールを保存する古くからある形式です。mbox メールボックスでは全てのメッセージが一つのファイルに保存されておりそれぞれのメッセージは &quot;From &quot; という5文字で始まる行を先頭に付けられています。</p>
<p>mbox 形式には幾つかのバリエーションがあり、それぞれオリジナルの形式にあった欠点を克服すると主張しています。互換性のために、 <a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a> はオリジナルの(時に <em class="dfn">mboxo</em> と呼ばれる) 形式を実装しています。すなわち、 <em class="mailheader">Content-Length</em> ヘッダはもしあっても無視され、メッセージのボディにある行頭の &quot;From &quot; はメッセージを保存する際に &quot;&gt;From &quot; に変換されますが、この &quot;&gt;From &quot; は読み出し時にも &quot;From &quot; に変換されません。</p>
<p><a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a> で実装された <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のいくつかのメソッドには特別な注意が必要です:</p>
<dl class="method">
<dt id="mailbox.mbox.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mbox.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.mbox" title="mailbox.mbox"><code class="xref py py-class docutils literal"><span class="pre">mbox</span></code></a> インスタンスに対し <code class="xref py py-meth docutils literal"><span class="pre">flush()</span></code> や <code class="xref py py-meth docutils literal"><span class="pre">close()</span></code> を呼び出した後でファイルを使用すると予期しない結果を引き起こしたり例外が送出されたりすることがあります。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mbox.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mbox.lock" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.mbox.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mbox.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>3種類のロック機構が使われます — ドットロッキングと、もし使用可能ならば <code class="xref c c-func docutils literal"><span class="pre">flock()</span></code> と <code class="xref c c-func docutils literal"><span class="pre">lockf()</span></code> システムコールです。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="http://www.qmail.org/man/man5/mbox.html">qmail の mbox マニュアルページ</a></dt>
<dd>mbox 形式の仕様および種々のバリエーション。</dd>
<dt><a class="reference external" href="http://www.tin.org/bin/man.cgi?section=5&amp;topic=mbox">tin の mbox マニュアルページ</a></dt>
<dd>もう一つの mbox 形式の仕様でロックについての詳細を含む。</dd>
<dt><a class="reference external" href="https://www.jwz.org/doc/content-length.html">Configuring Netscape Mail on Unix: Why The Content-Length Format is Bad</a></dt>
<dd>バリエーションの一つではなくオリジナルの mbox を使う理由。</dd>
<dt><a class="reference external" href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000383.shtml">&quot;mbox&quot; は相互に互換性を持たないいくつかのメールボックスフォーマットの集まりです</a></dt>
<dd>mbox バリエーションの歴史。</dd>
</dl>
</div>
</div>
<div class="section" id="mh">
<span id="mailbox-mh"></span><h3>19.4.1.3. <a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a><a class="headerlink" href="#mh" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.MH">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">MH</code><span class="sig-paren">(</span><em>path</em>, <em>factory=None</em>, <em>create=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MH 形式のメールボックスのための <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラス。パラメータ <em>factory</em> は呼び出し可能オブジェクトで (バイナリモードで開かれているかのように振る舞う)ファイル風メッセージ表現を受け付けて好みの表現を返すものです。 <em>factory</em> が <code class="docutils literal"><span class="pre">None</span></code> ならば、 <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> がデフォルトのメッセージ表現として使われます。 <em>create</em> が <code class="docutils literal"><span class="pre">True</span></code> ならばメールボックスが存在しないときには作成します。</p>
<p>MH はディレクトリに基づいたメールボックス形式で MH Message Handling System というメールユーザエージェントのために発明されました。 MH メールボックス中のそれぞれのメッセージは一つのファイルとして収められています。 MH メールボックスにはメッセージの他に別の MH メールボックス (<em class="dfn">フォルダ</em> と呼ばれます)を含んでもかまいません。フォルダは無限にネストできます。 MH メールボックスにはもう一つ <em class="dfn">シーケンス</em> という名前付きのリストでメッセージをサブフォルダに移動することなく論理的に分類するものがサポートされています。シーケンスは各フォルダの <code class="file docutils literal"><span class="pre">.mh_sequences</span></code> というファイルで定義されます。</p>
<p><a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> クラスは MH メールボックスを操作しますが、 <strong class="program">mh</strong> の動作の全てを模倣しようとはしていません。特に、 <strong class="program">mh</strong> が状態と設定を保存する <code class="file docutils literal"><span class="pre">context</span></code> や <code class="file docutils literal"><span class="pre">.mh_profile</span></code> といったファイルは書き換えませんし影響も受けません。</p>
<p><a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> インスタンスには <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> の全てのメソッドの他に次のメソッドがあります:</p>
<dl class="method">
<dt id="mailbox.MH.list_folders">
<code class="descname">list_folders</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.list_folders" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>全てのフォルダ名のリストを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.get_folder">
<code class="descname">get_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.get_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>folder</em> という名前のフォルダを表わす <a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> インスタンスを返します。もしフォルダが存在しなければ <a class="reference internal" href="#mailbox.NoSuchMailboxError" title="mailbox.NoSuchMailboxError"><code class="xref py py-exc docutils literal"><span class="pre">NoSuchMailboxError</span></code></a> 例外が送出されます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.add_folder">
<code class="descname">add_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.add_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>folder</em> という名前のフォルダを作成し、それを表わす <a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> インスタンスを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.remove_folder">
<code class="descname">remove_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.remove_folder" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>名前が <em>folder</em> であるフォルダを削除します。もしフォルダに一つでもメッセージが含まれていれば <a class="reference internal" href="#mailbox.NotEmptyError" title="mailbox.NotEmptyError"><code class="xref py py-exc docutils literal"><span class="pre">NotEmptyError</span></code></a> 例外が送出されフォルダは削除されません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.get_sequences">
<code class="descname">get_sequences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.get_sequences" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>folder</em> という名前のフォルダを削除します。フォルダにメッセージが一つでも残っていれば、<a class="reference internal" href="#mailbox.NotEmptyError" title="mailbox.NotEmptyError"><code class="xref py py-exc docutils literal"><span class="pre">NotEmptyError</span></code></a> 例外が送出されフォルダは削除されません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.set_sequences">
<code class="descname">set_sequences</code><span class="sig-paren">(</span><em>sequences</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.set_sequences" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>シーケンス名をキーのリストに対応付ける辞書を返します。シーケンスが一つもなければ空の辞書を返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.pack">
<code class="descname">pack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.pack" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックス中のシーケンスを <code class="xref py py-meth docutils literal"><span class="pre">get_sequences()</span></code> で返されるような名前とキーのリストを対応付ける辞書 <em>sequences</em> に基づいて再定義します。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">番号付けの間隔を詰める必要に応じてメールボックス中のメッセージの名前を付け替えます。シーケンスのリストのエントリもそれに応じて更新されます。</p>
</div>
</dd></dl>

<p>既に発行されたキーはこの操作によって無効になるのでそれ以降使ってはなりません:</p>
<dl class="method">
<dt id="mailbox.MH.remove">
<code class="descname">remove</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.remove" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.MH.__delitem__">
<code class="descname">__delitem__</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.__delitem__" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.MH.discard">
<code class="descname">discard</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.discard" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>これらのメソッドはメッセージを直ちに削除します。名前の前にコンマを付加してメッセージに削除の印を付けるという MH の規約は使いません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.lock" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.MH.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>3種類のロック機構が使われます — ドットロッキングと、もし使用可能ならば <code class="xref c c-func docutils literal"><span class="pre">flock()</span></code> と <code class="xref c c-func docutils literal"><span class="pre">lockf()</span></code> システムコールです。 MH メールボックスに対するロックとは <code class="file docutils literal"><span class="pre">.mh_sequences</span></code> のロックと、それが影響を与える操作中だけの個々のメッセージファイルに対するロックを意味します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ホストプラットフォームにより、ファイルが開かれたままの場合はメッセージを削除することができない場合があります。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.flush" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MH メールボックスへの変更は即時に適用されますのでこのメソッドは何もしません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MH.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MH.close" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> インスタンスは開いたファイルを保持しませんのでこのメソッドは <a class="reference internal" href="#mailbox.MH.unlock" title="mailbox.MH.unlock"><code class="xref py py-meth docutils literal"><span class="pre">unlock()</span></code></a> と同じです。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="http://www.nongnu.org/nmh/">nmh - Message Handling System</a></dt>
<dd><strong class="program">mh</strong> の改良版である <strong class="program">nmh</strong> のホームページ。</dd>
<dt><a class="reference external" href="http://rand-mh.sourceforge.net/book/">MH &amp; nmh: Email for Users &amp; Programmers</a></dt>
<dd>GPLライセンスの <strong class="program">mh</strong> および <strong class="program">nmh</strong> の本で、このメールボックス形式についての情報があります。</dd>
</dl>
</div>
</div>
<div class="section" id="babyl">
<span id="mailbox-babyl"></span><h3>19.4.1.4. <a class="reference internal" href="#mailbox.Babyl" title="mailbox.Babyl"><code class="xref py py-class docutils literal"><span class="pre">Babyl</span></code></a><a class="headerlink" href="#babyl" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.Babyl">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">Babyl</code><span class="sig-paren">(</span><em>path</em>, <em>factory=None</em>, <em>create=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Babyl" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Babyl 形式のメールボックスのための <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラス。パラメータ <em>factory</em> は呼び出し可能オブジェクトで (バイナリモードで開かれているかのように振る舞う)ファイル風メッセージ表現を受け付けて好みの表現を返すものです。 <em>factory</em> が <code class="docutils literal"><span class="pre">None</span></code> ならば、 <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> がデフォルトのメッセージ表現として使われます。 <em>create</em> が <code class="docutils literal"><span class="pre">True</span></code> ならばメールボックスが存在しないときには作成します。</p>
<p>Babyl は単一ファイルのメールボックス形式で Emacs に付属している Rmail メールユーザエージェントで使われているものです。メッセージの開始は Control-Underscore (<code class="docutils literal"><span class="pre">'\037'</span></code>) および Control-L (<code class="docutils literal"><span class="pre">'\014'</span></code>) の二文字を含む行で示されます。メッセージの終了は次のメッセージの開始または最後のメッセージの場合には Control-Underscore を含む行で示されます。</p>
<p>Babyl メールボックス中のメッセージには二つのヘッダのセット、オリジナルヘッダといわゆる可視ヘッダ、があります。可視ヘッダは典型的にはオリジナルヘッダの一部を分り易いように再整形したり短くしたりしたものです。 Babyl メールボックス中のそれぞれのメッセージには <em class="dfn">ラベル</em> というそのメッセージについての追加情報を記録する短い文字列のリストを伴い、メールボックス中に見出されるユーザが定義した全てのラベルのリストは Babyl オプションセクションに保持されます。</p>
<p><a class="reference internal" href="#mailbox.Babyl" title="mailbox.Babyl"><code class="xref py py-class docutils literal"><span class="pre">Babyl</span></code></a> インスタンスには <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> の全てのメソッドの他に次のメソッドがあります:</p>
<dl class="method">
<dt id="mailbox.Babyl.get_labels">
<code class="descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Babyl.get_labels" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスで使われているユーザが定義した全てのラベルのリストを返します。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">メールボックスにどのようなラベルが存在するかを決めるのに、Babyl オプションセクションのリストを参考にせず、実際のメッセージを捜索しますが、Babyl セクションもメールボックスが変更されたときにはいつでも更新されます。</p>
</div>
</dd></dl>

<p><a class="reference internal" href="#mailbox.Babyl" title="mailbox.Babyl"><code class="xref py py-class docutils literal"><span class="pre">Babyl</span></code></a> で実装された <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のいくつかのメソッドには特別な注意が必要です:</p>
<dl class="method">
<dt id="mailbox.Babyl.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Babyl.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Babyl メールボックスにおいて、メッセージのヘッダはボディと繋がって格納されていません。ファイル風の表現を生成するために、ヘッダとボディがファイルと同じ API を持つ <a class="reference internal" href="io.html#io.BytesIO" title="io.BytesIO"><code class="xref py py-class docutils literal"><span class="pre">io.BytesIO</span></code></a> インスタンスに一緒にコピーされます。その結果、ファイル風オブジェクトは元にしているメールボックスとは真に独立していますが、文字列表現と比べてメモリーを節約することにはなりません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.Babyl.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Babyl.lock" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.Babyl.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Babyl.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>3種類のロック機構が使われます — ドットロッキングと、もし使用可能ならば <code class="xref c c-func docutils literal"><span class="pre">flock()</span></code> と <code class="xref c c-func docutils literal"><span class="pre">lockf()</span></code> システムコールです。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="https://quimby.gnus.org/notes/BABYL">Format of Version 5 Babyl Files</a></dt>
<dd>Babyl 形式の仕様。</dd>
<dt><a class="reference external" href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Rmail.html">Reading Mail with Rmail</a></dt>
<dd>Rmail のマニュアルで Babyl のセマンティクスについての情報も少しある。</dd>
</dl>
</div>
</div>
<div class="section" id="mmdf">
<span id="mailbox-mmdf"></span><h3>19.4.1.5. <a class="reference internal" href="#mailbox.MMDF" title="mailbox.MMDF"><code class="xref py py-class docutils literal"><span class="pre">MMDF</span></code></a><a class="headerlink" href="#mmdf" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.MMDF">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">MMDF</code><span class="sig-paren">(</span><em>path</em>, <em>factory=None</em>, <em>create=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDF" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MMDF 形式のメールボックスのための <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラス。パラメータ <em>factory</em> は呼び出し可能オブジェクトで (バイナリモードで開かれているかのように振る舞う)ファイル風メッセージ表現を受け付けて好みの表現を返すものです。 <em>factory</em> が <code class="docutils literal"><span class="pre">None</span></code> ならば、 <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> がデフォルトのメッセージ表現として使われます。 <em>create</em> が <code class="docutils literal"><span class="pre">True</span></code> ならばメールボックスが存在しないときには作成します。</p>
<p>MMDF は単一ファイルのメールボックス形式で Multichannel Memorandum Distribution Facility というメール転送エージェント用に発明されたものです。各メッセージは mbox と同様の形式で収められますが、前後を4つの Control-A (<code class="docutils literal"><span class="pre">'\001'</span></code>) を含む行で挟んであります。mbox 形式と同じようにそれぞれのメッセージの開始は &quot;From &quot; の5文字を含む行で示されますが、それ以外の場所での &quot;From &quot; は格納の際 &quot;&gt;From &quot; には変えられません。それは追加されたメッセージ区切りによって新たなメッセージの開始と見間違うことが避けられるからです。</p>
<p><a class="reference internal" href="#mailbox.MMDF" title="mailbox.MMDF"><code class="xref py py-class docutils literal"><span class="pre">MMDF</span></code></a> で実装された <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のいくつかのメソッドには特別な注意が必要です:</p>
<dl class="method">
<dt id="mailbox.MMDF.get_file">
<code class="descname">get_file</code><span class="sig-paren">(</span><em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDF.get_file" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.MMDF" title="mailbox.MMDF"><code class="xref py py-class docutils literal"><span class="pre">MMDF</span></code></a> インスタンスに対し <code class="xref py py-meth docutils literal"><span class="pre">flush()</span></code> や <code class="xref py py-meth docutils literal"><span class="pre">close()</span></code> を呼び出した後でファイルを使用すると予期しない結果を引き起こしたり例外が送出されたりすることがあります。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDF.lock">
<code class="descname">lock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDF.lock" title="この定義へのパーマリンク">¶</a></dt>
<dt id="mailbox.MMDF.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDF.unlock" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>3種類のロック機構が使われます — ドットロッキングと、もし使用可能ならば <code class="xref c c-func docutils literal"><span class="pre">flock()</span></code> と <code class="xref c c-func docutils literal"><span class="pre">lockf()</span></code> システムコールです。</p>
</dd></dl>

</dd></dl>

<div class="admonition seealso">
<p class="first admonition-title">参考</p>
<dl class="last docutils">
<dt><a class="reference external" href="http://www.tin.org/bin/man.cgi?section=5&amp;topic=mmdf">mmdf man page from tin</a></dt>
<dd>ニュースリーダ tin のドキュメント中の MMDF 形式仕様。</dd>
<dt><a class="reference external" href="https://en.wikipedia.org/wiki/MMDF">MMDF</a></dt>
<dd>Multichannel Memorandum Distribution Facility についてのウィキペディアの記事。</dd>
</dl>
</div>
</div>
</div>
<div class="section" id="message-objects">
<span id="mailbox-message-objects"></span><h2>19.4.2. <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> objects<a class="headerlink" href="#message-objects" title="このヘッドラインへのパーマリンク">¶</a></h2>
<dl class="class">
<dt id="mailbox.Message">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">Message</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.Message" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="email.message.html#module-email.message" title="email.message: The base class representing email messages."><code class="xref py py-mod docutils literal"><span class="pre">email.message</span></code></a> モジュールの <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のサブクラス。 <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">mailbox.Message</span></code></a> のサブクラスはメールボックス形式ごとの状態と動作を追加します。</p>
<p><em>message</em> が省略された場合、新しいインスタンスはデフォルトの空の状態で生成されます。 <em>message</em> が <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">email.message.Message</span></code></a> インスタンスならばその内容がコピーされます。さらに、 <em>message</em> が <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンスならば、形式固有の情報も可能な限り変換されます。 <em>message</em> が文字列かバイト列またはファイルならば、読まれ解析されるべき <span class="target" id="index-2"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc2822.html"><strong>RFC 2822</strong></a> 準拠のメッセージを含んでいなければなりません。ファイルはバイナリモードで開かれているべきですが、後方互換性のためテキストモードファイルも受け付けます。</p>
<p>サブクラスにより提供される形式ごとの状態と動作は様々ですが、一般に或るメールボックスに固有のものでないプロパティだけがサポートされます(おそらくプロパティのセットはメールボックス形式ごとに固有でしょうが)。例えば、単一ファイルメールボックス形式におけるファイルオフセットやディレクトリ式メールボックス形式におけるファイル名は保持されません、というのもそれらは元々のメールボックスにしか適用できないからです。しかし、メッセージがユーザに読まれたかどうかあるいは重要だとマークされたかどうかという状態は保持されます、というのはそれらはメッセージ自体に適用されるからです。</p>
<p><a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスを使って取得したメッセージを表現するのに <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンスが使われなければいけないとは要求していません。ある種の状況では <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> による表現を生成するのに必要な時間やメモリーが受け入れられないこともあります。そういった状況では <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスは文字列やファイル風オブジェクトの表現も提供できますし、 <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> インスタンスを初期化する際にメッセージファクトリーを指定することもできます。</p>
</dd></dl>

<div class="section" id="maildirmessage">
<span id="mailbox-maildirmessage"></span><h3>19.4.2.1. <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a><a class="headerlink" href="#maildirmessage" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.MaildirMessage">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">MaildirMessage</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Maildir 固有の動作をするメッセージ。引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のコンストラクタと同じ意味を持ちます。</p>
<p>通常、メールユーザエージェントは <code class="file docutils literal"><span class="pre">new</span></code> サブディレクトリにある全てのメッセージをユーザが最初にメールボックスを開くか閉じるかした後で <code class="file docutils literal"><span class="pre">cur</span></code> サブディレクトリに移動し、メッセージが実際に読まれたかどうかを記録します。 <code class="file docutils literal"><span class="pre">cur</span></code> にある各メッセージには状態情報を保存するファイル名に付け加えられた &quot;info&quot; セクションがあります。(メールリーダの中には &quot;info&quot; セクションを <code class="file docutils literal"><span class="pre">new</span></code> にあるメッセージに付けることもあります。) &quot;info&quot; セクションには二つの形式があります。一つは &quot;2,&quot; の後に標準化されたフラグのリストを付けたもの (たとえば &quot;2,FR&quot;)、もう一つは &quot;1,&quot; の後にいわゆる実験的情報を付け加えるものです。 Maildir の標準的なフラグは以下の通りです:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="19%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">意味</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>D</td>
<td>ドラフト(Draft)</td>
<td>作成中</td>
</tr>
<tr class="row-odd"><td>F</td>
<td>フラグ付き(Flagged)</td>
<td>重要とされたもの</td>
</tr>
<tr class="row-even"><td>P</td>
<td>通過(Passed)</td>
<td>転送、再送またはバウンス</td>
</tr>
<tr class="row-odd"><td>R</td>
<td>返答済み(Replied)</td>
<td>返答されたもの</td>
</tr>
<tr class="row-even"><td>S</td>
<td>既読(Seen)</td>
<td>読んだもの</td>
</tr>
<tr class="row-odd"><td>T</td>
<td>ごみ(Trashed)</td>
<td>削除予定とされたもの</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスは以下のメソッドを提供します:</p>
<dl class="method">
<dt id="mailbox.MaildirMessage.get_subdir">
<code class="descname">get_subdir</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.get_subdir" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>&quot;new&quot; (メッセージが <code class="file docutils literal"><span class="pre">new</span></code> サブディレクトリに保存されるべき場合) または &quot;cur&quot; (メッセージが <code class="file docutils literal"><span class="pre">cur</span></code> サブディレクトリに保存されるべき場合)のどちらかを返します。</p>
<div class="admonition note">
<p class="first admonition-title">注釈</p>
<p class="last">メッセージは通常メールボックスがアクセスされた後、メッセージが読まれたかどうかに関わらず <code class="file docutils literal"><span class="pre">new</span></code> から <code class="file docutils literal"><span class="pre">cur</span></code> に移動されます。メッセージ <code class="docutils literal"><span class="pre">msg</span></code> は <code class="docutils literal"><span class="pre">&quot;S&quot;</span> <span class="pre">in</span> <span class="pre">msg.get_flags()</span></code> が <code class="docutils literal"><span class="pre">True</span></code> ならば読まれています。</p>
</div>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.set_subdir">
<code class="descname">set_subdir</code><span class="sig-paren">(</span><em>subdir</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.set_subdir" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージが保存されるべきサブディレクトリをセットします。パラメータ <em>subdir</em> は &quot;new&quot; または &quot;cur&quot; のいずれかでなければなりません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.get_flags">
<code class="descname">get_flags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.get_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>現在セットされているフラグを特定する文字列を返します。メッセージが標準 Maildir 形式に準拠しているならば、結果はアルファベット順に並べられたゼロまたは1回の <code class="docutils literal"><span class="pre">'D'</span></code>、<code class="docutils literal"><span class="pre">'F'</span></code>、<code class="docutils literal"><span class="pre">'P'</span></code>、<code class="docutils literal"><span class="pre">'R'</span></code>、<code class="docutils literal"><span class="pre">'S'</span></code>、<code class="docutils literal"><span class="pre">'T'</span></code> をつなげたものです。空文字列が返されるのはフラグが一つもない場合、または &quot;info&quot; が実験的セマンティクスを使っている場合です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.set_flags">
<code class="descname">set_flags</code><span class="sig-paren">(</span><em>flags</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.set_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flags</em> で指定されたフラグをセットし、他のフラグは下ろします。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.add_flag">
<code class="descname">add_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.add_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグをセットしますが他のフラグは変えません。一度に二つ以上のフラグをセットすることは、<em>flag</em> に2文字以上の文字列を指定すればできます。現在の &quot;info&quot; はフラグの代わりに実験的情報を使っていても上書きされます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.remove_flag">
<code class="descname">remove_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.remove_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグを下ろしますが他のフラグは変えません。一度に二つ以上のフラグを取り除くことは、<em>flag</em> に2文字以上の文字列を指定すればできます。&quot;info&quot; がフラグの代わりに実験的情報を使っている場合は現在の &quot;info&quot; は書き換えられません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.get_date">
<code class="descname">get_date</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.get_date" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージの配送日時をエポックからの秒数を表わす浮動小数点数で返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.set_date">
<code class="descname">set_date</code><span class="sig-paren">(</span><em>date</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.set_date" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージの配送日時を <em>date</em> にセットします。<em>date</em> はエポックからの秒数を表わす浮動小数点数です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.get_info">
<code class="descname">get_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.get_info" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージの &quot;info&quot; を含む文字列を返します。このメソッドは実験的 (即ちフラグのリストでない) &quot;info&quot; にアクセスし、また変更するのに役立ちます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MaildirMessage.set_info">
<code class="descname">set_info</code><span class="sig-paren">(</span><em>info</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MaildirMessage.set_info" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>&quot;info&quot; に文字列 <em>info</em> をセットします。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> や <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> のインスタンスに基づいて生成されるとき、 <em class="mailheader">Status</em> および <em class="mailheader">X-Status</em> ヘッダは省かれ以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> または <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;cur&quot; サブディレクトリ</td>
<td>O フラグ</td>
</tr>
<tr class="row-odd"><td>F フラグ</td>
<td>F フラグ</td>
</tr>
<tr class="row-even"><td>R フラグ</td>
<td>A フラグ</td>
</tr>
<tr class="row-odd"><td>S フラグ</td>
<td>R フラグ</td>
</tr>
<tr class="row-even"><td>T フラグ</td>
<td>D フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="54%" />
<col width="46%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;cur&quot; サブディレクトリ</td>
<td>&quot;unseen&quot; シーケンス</td>
</tr>
<tr class="row-odd"><td>&quot;cur&quot; サブディレクトリおよび S フラグ</td>
<td>&quot;unseen&quot; シーケンス無し</td>
</tr>
<tr class="row-even"><td>F フラグ</td>
<td>&quot;flagged&quot; シーケンス</td>
</tr>
<tr class="row-odd"><td>R フラグ</td>
<td>&quot;replied&quot; シーケンス</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;cur&quot; サブディレクトリ</td>
<td>&quot;unseen&quot; ラベル</td>
</tr>
<tr class="row-odd"><td>&quot;cur&quot; サブディレクトリおよび S フラグ</td>
<td>&quot;unseen&quot; ラベル無し</td>
</tr>
<tr class="row-even"><td>P フラグ</td>
<td>&quot;forwarded&quot; または &quot;resent&quot; ラベル</td>
</tr>
<tr class="row-odd"><td>R フラグ</td>
<td>&quot;answered&quot; ラベル</td>
</tr>
<tr class="row-even"><td>T フラグ</td>
<td>&quot;deleted&quot; ラベル</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mboxmessage">
<span id="mailbox-mboxmessage"></span><h3>19.4.2.2. <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a><a class="headerlink" href="#mboxmessage" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.mboxMessage">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">mboxMessage</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>mbox 固有の動作をするメッセージ。引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のコンストラクタと同じ意味を持ちます。</p>
<p>mbox メールボックス中のメッセージは単一ファイルにまとめて格納されています。送り主のエンベロープアドレスおよび配送日時は通常メッセージの開始を示す &quot;From &quot; から始まる行に記録されますが、正確なフォーマットに関しては mbox の実装ごとに大きな違いがあります。メッセージの状態を示すフラグ、たとえば読んだかどうかあるいは重要だとマークを付けられているかどうかといったようなもの、は典型的には <em class="mailheader">Status</em> および <em class="mailheader">X-Status</em> に収められます。</p>
<p>規定されている mbox メッセージのフラグは以下の通りです:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="21%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">意味</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R</td>
<td>読んだもの</td>
<td>読んだもの</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>古い(Old)</td>
<td>以前に MUA に発見された</td>
</tr>
<tr class="row-even"><td>D</td>
<td>削除(Deleted)</td>
<td>削除予定とされたもの</td>
</tr>
<tr class="row-odd"><td>F</td>
<td>フラグ付き(Flagged)</td>
<td>重要とされたもの</td>
</tr>
<tr class="row-even"><td>A</td>
<td>返答済み(Answered)</td>
<td>返答されたもの</td>
</tr>
</tbody>
</table>
<p>&quot;R&quot; および &quot;O&quot; フラグは <em class="mailheader">Status</em> ヘッダに記録され、 &quot;D&quot;、&quot;F&quot;、&quot;A&quot; フラグは <em class="mailheader">X-Status</em> ヘッダに記録されます。フラグとヘッダは通常記述された順番に出現します。</p>
<p><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスは以下のメソッドを提供します:</p>
<dl class="method">
<dt id="mailbox.mboxMessage.get_from">
<code class="descname">get_from</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.get_from" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>mbox メールボックスのメッセージの開始を示す &quot;From &quot; 行を表わす文字列を返します。先頭の &quot;From &quot; および末尾の改行は含まれません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mboxMessage.set_from">
<code class="descname">set_from</code><span class="sig-paren">(</span><em>from_</em>, <em>time_=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.set_from" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>&quot;From &quot; 行を <em>from_</em> にセットします。 <em>from_</em> は先頭の &quot;From &quot; や末尾の改行を含まない形で指定しなければなりません。利便性のために、 <em>time_</em> を指定して適切に整形して <em>from_</em> に追加させることができます。 <em>time_</em> を指定する場合、それは <a class="reference internal" href="time.html#time.struct_time" title="time.struct_time"><code class="xref py py-class docutils literal"><span class="pre">time.struct_time</span></code></a> インスタンス、 <a class="reference internal" href="time.html#time.strftime" title="time.strftime"><code class="xref py py-meth docutils literal"><span class="pre">time.strftime()</span></code></a> に渡すのに適したタプル、または <code class="docutils literal"><span class="pre">True</span></code> (この場合 <a class="reference internal" href="time.html#time.gmtime" title="time.gmtime"><code class="xref py py-meth docutils literal"><span class="pre">time.gmtime()</span></code></a> を使います) のいずれかでなければなりません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mboxMessage.get_flags">
<code class="descname">get_flags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.get_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>現在セットされているフラグを特定する文字列を返します。メッセージが規定された形式に準拠しているならば、結果は次の順に並べられた 0回か1回の <code class="docutils literal"><span class="pre">'R'</span></code>、<code class="docutils literal"><span class="pre">'O'</span></code>、<code class="docutils literal"><span class="pre">'D'</span></code>、<code class="docutils literal"><span class="pre">'F'</span></code>、<code class="docutils literal"><span class="pre">'A'</span></code> です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mboxMessage.set_flags">
<code class="descname">set_flags</code><span class="sig-paren">(</span><em>flags</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.set_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flags</em> で指定されたフラグをセットして、他のフラグは下ろします。<em>flags</em> は並べられたゼロまたは1回の <code class="docutils literal"><span class="pre">'R'</span></code>、<code class="docutils literal"><span class="pre">'O'</span></code>、<code class="docutils literal"><span class="pre">'D'</span></code>、<code class="docutils literal"><span class="pre">'F'</span></code>、<code class="docutils literal"><span class="pre">'A'</span></code> です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mboxMessage.add_flag">
<code class="descname">add_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.add_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグをセットしますが他のフラグは変えません。一度に二つ以上のフラグをセットすることは、<em>flag</em> に2文字以上の文字列を指定すればできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.mboxMessage.remove_flag">
<code class="descname">remove_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.mboxMessage.remove_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグを下ろしますが他のフラグは変えません。一二つ以上のフラグを取り除くことは、<em>flag</em> に2文字以上の文字列を指定すればできます。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスに基づいて生成されるとき、 <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスの配送日時に基づいて &quot;From &quot; 行が作り出され、次の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグ</td>
<td>S フラグ</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;cur&quot; サブディレクトリ</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>T フラグ</td>
</tr>
<tr class="row-odd"><td>F フラグ</td>
<td>F フラグ</td>
</tr>
<tr class="row-even"><td>A フラグ</td>
<td>R フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグおよび O フラグ</td>
<td>&quot;unseen&quot; シーケンス無し</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;unseen&quot; シーケンス</td>
</tr>
<tr class="row-even"><td>F フラグ</td>
<td>&quot;flagged&quot; シーケンス</td>
</tr>
<tr class="row-odd"><td>A フラグ</td>
<td>&quot;replied&quot; シーケンス</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグおよび O フラグ</td>
<td>&quot;unseen&quot; ラベル無し</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;unseen&quot; ラベル</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>&quot;deleted&quot; ラベル</td>
</tr>
<tr class="row-odd"><td>A フラグ</td>
<td>&quot;answered&quot; ラベル</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスに基づいて生成されるとき、&quot;From &quot; 行はコピーされ全てのフラグは直接対応します:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグ</td>
<td>R フラグ</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>O フラグ</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>D フラグ</td>
</tr>
<tr class="row-odd"><td>F フラグ</td>
<td>F フラグ</td>
</tr>
<tr class="row-even"><td>A フラグ</td>
<td>A フラグ</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mhmessage">
<span id="mailbox-mhmessage"></span><h3>19.4.2.3. <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a><a class="headerlink" href="#mhmessage" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.MHMessage">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">MHMessage</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MHMessage" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MH 固有の動作をするメッセージ。引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のコンストラクタと同じ意味を持ちます。</p>
<p>MH メッセージは伝統的な意味あいにおいてマークやフラグをサポートしません。しかし、MH メッセージにはシーケンスがあり任意のメッセージを論理的にグループ分けできます。いくつかのメールソフト(標準の <strong class="program">mh</strong> や <strong class="program">nmh</strong> はそうではありませんが) は他の形式におけるフラグとほぼ同じようにシーケンスを使います:</p>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="81%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">シーケンス</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>unseen</td>
<td>読んではいないが既にMUAに見つけられている</td>
</tr>
<tr class="row-odd"><td>replied</td>
<td>返答されたもの</td>
</tr>
<tr class="row-even"><td>flagged</td>
<td>重要とされたもの</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスは以下のメソッドを提供します:</p>
<dl class="method">
<dt id="mailbox.MHMessage.get_sequences">
<code class="descname">get_sequences</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MHMessage.get_sequences" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このメッセージを含むシーケンスの名前のリストを返す。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MHMessage.set_sequences">
<code class="descname">set_sequences</code><span class="sig-paren">(</span><em>sequences</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MHMessage.set_sequences" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>このメッセージを含むシーケンスのリストをセットする。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MHMessage.add_sequence">
<code class="descname">add_sequence</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MHMessage.add_sequence" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>sequence</em> をこのメッセージを含むシーケンスのリストに追加する。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MHMessage.remove_sequence">
<code class="descname">remove_sequence</code><span class="sig-paren">(</span><em>sequence</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MHMessage.remove_sequence" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>sequence</em> をこのメッセージを含むシーケンスのリストから除く。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; シーケンス</td>
<td>S フラグ無し</td>
</tr>
<tr class="row-odd"><td>&quot;replied&quot; シーケンス</td>
<td>R フラグ</td>
</tr>
<tr class="row-even"><td>&quot;flagged&quot; シーケンス</td>
<td>F フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> や <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> のインスタンスに基づいて生成されるとき、 <em class="mailheader">Status</em> および <em class="mailheader">X-Status</em> ヘッダは省かれ以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> または <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; シーケンス</td>
<td>R フラグ無し</td>
</tr>
<tr class="row-odd"><td>&quot;replied&quot; シーケンス</td>
<td>A フラグ</td>
</tr>
<tr class="row-even"><td>&quot;flagged&quot; シーケンス</td>
<td>F フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; シーケンス</td>
<td>&quot;unseen&quot; ラベル</td>
</tr>
<tr class="row-odd"><td>&quot;replied&quot; シーケンス</td>
<td>&quot;answered&quot; ラベル</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="babylmessage">
<span id="mailbox-babylmessage"></span><h3>19.4.2.4. <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a><a class="headerlink" href="#babylmessage" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.BabylMessage">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">BabylMessage</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Babyl 固有の動作をするメッセージ。引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のコンストラクタと同じ意味を持ちます。</p>
<p>ある種のメッセージラベルは <em class="dfn">アトリビュート</em> と呼ばれ、規約により特別な意味が与えられています。アトリビュートは以下の通りです:</p>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">ラベル</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>unseen</td>
<td>読んではいないが既にMUAに見つけられている</td>
</tr>
<tr class="row-odd"><td>deleted</td>
<td>削除予定とされたもの</td>
</tr>
<tr class="row-even"><td>filed</td>
<td>他のファイルまたはメールボックスにコピーされた</td>
</tr>
<tr class="row-odd"><td>answered</td>
<td>返答されたもの</td>
</tr>
<tr class="row-even"><td>forwarded</td>
<td>転送された</td>
</tr>
<tr class="row-odd"><td>edited</td>
<td>ユーザによって変更された</td>
</tr>
<tr class="row-even"><td>resent</td>
<td>再送された</td>
</tr>
</tbody>
</table>
<p>デフォルトでは Rmail は可視ヘッダのみ表示します。 <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> クラスはしかし、オリジナルヘッダをより完全だという理由で使います。可視ヘッダは望むならそのように指示してアクセスすることができます。</p>
<p><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスは以下のメソッドを提供します:</p>
<dl class="method">
<dt id="mailbox.BabylMessage.get_labels">
<code class="descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.get_labels" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージに付いているラベルのリストを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.set_labels">
<code class="descname">set_labels</code><span class="sig-paren">(</span><em>labels</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.set_labels" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージに付いているラベルのリストを <em>labels</em> にセットします。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.add_label">
<code class="descname">add_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.add_label" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージに付いているラベルのリストに <em>label</em> を追加します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.remove_label">
<code class="descname">remove_label</code><span class="sig-paren">(</span><em>label</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.remove_label" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージに付いているラベルのリストから <em>label</em> を削除します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.get_visible">
<code class="descname">get_visible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.get_visible" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ヘッダがメッセージの可視ヘッダでありボディが空であるような <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンスを返します。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.set_visible">
<code class="descname">set_visible</code><span class="sig-paren">(</span><em>visible</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.set_visible" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メッセージの可視ヘッダを <em>visible</em> のヘッダと同じにセットします。引数 <em>visible</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> インスタンスまたは <a class="reference internal" href="email.compat32-message.html#email.message.Message" title="email.message.Message"><code class="xref py py-class docutils literal"><span class="pre">email.message.Message</span></code></a> インスタンス、文字列、ファイル風オブジェクト(テキストモードで開かれてなければなりません)のいずれかです。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.BabylMessage.update_visible">
<code class="descname">update_visible</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.BabylMessage.update_visible" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスのオリジナルヘッダが変更されたとき、可視ヘッダは自動的に対応して変更されるわけではありません。このメソッドは可視ヘッダを以下のように更新します。対応するオリジナルヘッダのある可視ヘッダはオリジナルヘッダの値がセットされます。対応するオリジナルヘッダの無い可視ヘッダは除去されます。そして、オリジナルヘッダにあって可視ヘッダに無い <em class="mailheader">Date</em> 、 <em class="mailheader">From</em> 、 <em class="mailheader">Reply-To</em> 、 <em class="mailheader">To</em> 、 <em class="mailheader">CC</em> 、 <em class="mailheader">Subject</em> は可視ヘッダに追加されます。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; ラベル</td>
<td>S フラグ無し</td>
</tr>
<tr class="row-odd"><td>&quot;deleted&quot; ラベル</td>
<td>T フラグ</td>
</tr>
<tr class="row-even"><td>&quot;answered&quot; ラベル</td>
<td>R フラグ</td>
</tr>
<tr class="row-odd"><td>&quot;forwarded&quot; ラベル</td>
<td>P フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> や <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> のインスタンスに基づいて生成されるとき、 <em class="mailheader">Status</em> および <em class="mailheader">X-Status</em> ヘッダは省かれ以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="28%" />
<col width="72%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> または <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; ラベル</td>
<td>R フラグ無し</td>
</tr>
<tr class="row-odd"><td>&quot;deleted&quot; ラベル</td>
<td>D フラグ</td>
</tr>
<tr class="row-even"><td>&quot;answered&quot; ラベル</td>
<td>A フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&quot;unseen&quot; ラベル</td>
<td>&quot;unseen&quot; シーケンス</td>
</tr>
<tr class="row-odd"><td>&quot;answered&quot; ラベル</td>
<td>&quot;replied&quot; シーケンス</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mmdfmessage">
<span id="mailbox-mmdfmessage"></span><h3>19.4.2.5. <a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a><a class="headerlink" href="#mmdfmessage" title="このヘッドラインへのパーマリンク">¶</a></h3>
<dl class="class">
<dt id="mailbox.MMDFMessage">
<em class="property">class </em><code class="descclassname">mailbox.</code><code class="descname">MMDFMessage</code><span class="sig-paren">(</span><em>message=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>MMDF 固有の動作をするメッセージ。引数 <em>message</em> は <a class="reference internal" href="#mailbox.Message" title="mailbox.Message"><code class="xref py py-class docutils literal"><span class="pre">Message</span></code></a> のコンストラクタと同じ意味を持ちます。</p>
<p>mbox メールボックスのメッセージと同様に、MMDF メッセージは送り主のアドレスと配送日時が最初の &quot;From &quot; で始まる行に記録されています。同様に、メッセージの状態を示すフラグは通常 <em class="mailheader">Status</em> および <em class="mailheader">X-Status</em> ヘッダに収められています。</p>
<p>よく使われる MMDF メッセージのフラグは mbox メッセージのものと同一で以下の通りです:</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="21%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Flag</th>
<th class="head">意味</th>
<th class="head">説明</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R</td>
<td>読んだもの</td>
<td>読んだもの</td>
</tr>
<tr class="row-odd"><td>O</td>
<td>古い(Old)</td>
<td>以前に MUA に発見された</td>
</tr>
<tr class="row-even"><td>D</td>
<td>削除(Deleted)</td>
<td>削除予定とされたもの</td>
</tr>
<tr class="row-odd"><td>F</td>
<td>フラグ付き(Flagged)</td>
<td>重要とされたもの</td>
</tr>
<tr class="row-even"><td>A</td>
<td>返答済み(Answered)</td>
<td>返答されたもの</td>
</tr>
</tbody>
</table>
<p>&quot;R&quot; および &quot;O&quot; フラグは <em class="mailheader">Status</em> ヘッダに記録され、 &quot;D&quot;、&quot;F&quot;、&quot;A&quot; フラグは <em class="mailheader">X-Status</em> ヘッダに記録されます。フラグとヘッダは通常記述された順番に出現します。</p>
<p><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスは <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスと同一の以下のメソッドを提供します:</p>
<dl class="method">
<dt id="mailbox.MMDFMessage.get_from">
<code class="descname">get_from</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.get_from" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>mbox メールボックスのメッセージの開始を示す &quot;From &quot; 行を表わす文字列を返します。先頭の &quot;From &quot; および末尾の改行は含まれません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDFMessage.set_from">
<code class="descname">set_from</code><span class="sig-paren">(</span><em>from_</em>, <em>time_=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.set_from" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>&quot;From &quot; 行を <em>from_</em> にセットします。 <em>from_</em> は先頭の &quot;From &quot; や末尾の改行を含まない形で指定しなければなりません。利便性のために、 <em>time_</em> を指定して適切に整形して <em>from_</em> に追加させることができます。 <em>time_</em> を指定する場合、それは <a class="reference internal" href="time.html#time.struct_time" title="time.struct_time"><code class="xref py py-class docutils literal"><span class="pre">time.struct_time</span></code></a> インスタンス、 <a class="reference internal" href="time.html#time.strftime" title="time.strftime"><code class="xref py py-meth docutils literal"><span class="pre">time.strftime()</span></code></a> に渡すのに適したタプル、または <code class="docutils literal"><span class="pre">True</span></code> (この場合 <a class="reference internal" href="time.html#time.gmtime" title="time.gmtime"><code class="xref py py-meth docutils literal"><span class="pre">time.gmtime()</span></code></a> を使います) のいずれかでなければなりません。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDFMessage.get_flags">
<code class="descname">get_flags</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.get_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>現在セットされているフラグを特定する文字列を返します。メッセージが規定された形式に準拠しているならば、結果は次の順に並べられた 0回か1回の <code class="docutils literal"><span class="pre">'R'</span></code>、<code class="docutils literal"><span class="pre">'O'</span></code>、<code class="docutils literal"><span class="pre">'D'</span></code>、<code class="docutils literal"><span class="pre">'F'</span></code>、<code class="docutils literal"><span class="pre">'A'</span></code> です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDFMessage.set_flags">
<code class="descname">set_flags</code><span class="sig-paren">(</span><em>flags</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.set_flags" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flags</em> で指定されたフラグをセットして、他のフラグは下ろします。<em>flags</em> は並べられたゼロまたは1回の <code class="docutils literal"><span class="pre">'R'</span></code>、<code class="docutils literal"><span class="pre">'O'</span></code>、<code class="docutils literal"><span class="pre">'D'</span></code>、<code class="docutils literal"><span class="pre">'F'</span></code>、<code class="docutils literal"><span class="pre">'A'</span></code> です。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDFMessage.add_flag">
<code class="descname">add_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.add_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグをセットしますが他のフラグは変えません。一度に二つ以上のフラグをセットすることは、<em>flag</em> に2文字以上の文字列を指定すればできます。</p>
</dd></dl>

<dl class="method">
<dt id="mailbox.MMDFMessage.remove_flag">
<code class="descname">remove_flag</code><span class="sig-paren">(</span><em>flag</em><span class="sig-paren">)</span><a class="headerlink" href="#mailbox.MMDFMessage.remove_flag" title="この定義へのパーマリンク">¶</a></dt>
<dd><p><em>flag</em> で指定されたフラグを下ろしますが他のフラグは変えません。一二つ以上のフラグを取り除くことは、<em>flag</em> に2文字以上の文字列を指定すればできます。</p>
</dd></dl>

</dd></dl>

<p><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスに基づいて生成されるとき、&quot;From&quot;行が <a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> インスタンスの配信日をもとに生成され、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MaildirMessage" title="mailbox.MaildirMessage"><code class="xref py py-class docutils literal"><span class="pre">MaildirMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグ</td>
<td>S フラグ</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;cur&quot; サブディレクトリ</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>T フラグ</td>
</tr>
<tr class="row-odd"><td>F フラグ</td>
<td>F フラグ</td>
</tr>
<tr class="row-even"><td>A フラグ</td>
<td>R フラグ</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="42%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.MHMessage" title="mailbox.MHMessage"><code class="xref py py-class docutils literal"><span class="pre">MHMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグおよび O フラグ</td>
<td>&quot;unseen&quot; シーケンス無し</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;unseen&quot; シーケンス</td>
</tr>
<tr class="row-even"><td>F フラグ</td>
<td>&quot;flagged&quot; シーケンス</td>
</tr>
<tr class="row-odd"><td>A フラグ</td>
<td>&quot;replied&quot; シーケンス</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> インスタンスに基づいて生成されるとき、以下の変換が行われます:</p>
<table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.BabylMessage" title="mailbox.BabylMessage"><code class="xref py py-class docutils literal"><span class="pre">BabylMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグおよび O フラグ</td>
<td>&quot;unseen&quot; ラベル無し</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>&quot;unseen&quot; ラベル</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>&quot;deleted&quot; ラベル</td>
</tr>
<tr class="row-odd"><td>A フラグ</td>
<td>&quot;answered&quot; ラベル</td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#mailbox.MMDFMessage" title="mailbox.MMDFMessage"><code class="xref py py-class docutils literal"><span class="pre">MMDFMessage</span></code></a> インスタンスが <a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> インスタンスに基づいて生成されるとき、&quot;From&quot;行がコピーされ、全てのフラグが直接対応します:</p>
<table border="1" class="docutils">
<colgroup>
<col width="38%" />
<col width="62%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">結果の状態</th>
<th class="head"><a class="reference internal" href="#mailbox.mboxMessage" title="mailbox.mboxMessage"><code class="xref py py-class docutils literal"><span class="pre">mboxMessage</span></code></a> の状態</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>R フラグ</td>
<td>R フラグ</td>
</tr>
<tr class="row-odd"><td>O フラグ</td>
<td>O フラグ</td>
</tr>
<tr class="row-even"><td>D フラグ</td>
<td>D フラグ</td>
</tr>
<tr class="row-odd"><td>F フラグ</td>
<td>F フラグ</td>
</tr>
<tr class="row-even"><td>A フラグ</td>
<td>A フラグ</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="exceptions">
<h2>19.4.3. 例外<a class="headerlink" href="#exceptions" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><a class="reference internal" href="#module-mailbox" title="mailbox: Manipulate mailboxes in various formats"><code class="xref py py-mod docutils literal"><span class="pre">mailbox</span></code></a> モジュールでは以下の例外クラスが定義されています:</p>
<dl class="exception">
<dt id="mailbox.Error">
<em class="property">exception </em><code class="descclassname">mailbox.</code><code class="descname">Error</code><a class="headerlink" href="#mailbox.Error" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>他の全てのモジュール固有の例外の基底クラス。</p>
</dd></dl>

<dl class="exception">
<dt id="mailbox.NoSuchMailboxError">
<em class="property">exception </em><code class="descclassname">mailbox.</code><code class="descname">NoSuchMailboxError</code><a class="headerlink" href="#mailbox.NoSuchMailboxError" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスがあると思っていたが見つからなかった場合に送出されます。これはたとえば <a class="reference internal" href="#mailbox.Mailbox" title="mailbox.Mailbox"><code class="xref py py-class docutils literal"><span class="pre">Mailbox</span></code></a> のサブクラスを存在しないパスでインスタンス化しようとしたとき(かつ <em>create</em> パラメータは <code class="docutils literal"><span class="pre">False</span></code> であった場合)、あるいは存在しないフォルダを開こうとした時などに発生します。</p>
</dd></dl>

<dl class="exception">
<dt id="mailbox.NotEmptyError">
<em class="property">exception </em><code class="descclassname">mailbox.</code><code class="descname">NotEmptyError</code><a class="headerlink" href="#mailbox.NotEmptyError" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスが空であることを期待されているときに空でない場合、たとえばメッセージの残っているフォルダを削除しようとした時などに送出されます。</p>
</dd></dl>

<dl class="exception">
<dt id="mailbox.ExternalClashError">
<em class="property">exception </em><code class="descclassname">mailbox.</code><code class="descname">ExternalClashError</code><a class="headerlink" href="#mailbox.ExternalClashError" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>メールボックスに関係したある条件がプログラムの制御を外れてそれ以上作業を続けられなくなった場合、たとえば他のプログラムが既に保持しているロックを取得しようとして失敗したとき、あるいは一意的に生成されたファイル名が既に存在していた場合などに送出されます。</p>
</dd></dl>

<dl class="exception">
<dt id="mailbox.FormatError">
<em class="property">exception </em><code class="descclassname">mailbox.</code><code class="descname">FormatError</code><a class="headerlink" href="#mailbox.FormatError" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>ファイル中のデータが解析できない場合、たとえば <a class="reference internal" href="#mailbox.MH" title="mailbox.MH"><code class="xref py py-class docutils literal"><span class="pre">MH</span></code></a> インスタンスが壊れた <code class="file docutils literal"><span class="pre">.mh_sequences</span></code> ファイルを読もうと試みた場合などに送出されます。</p>
</dd></dl>

</div>
<div class="section" id="examples">
<span id="mailbox-examples"></span><h2>19.4.4. 使用例<a class="headerlink" href="#examples" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>メールボックス中の面白そうなメッセージのサブジェクトを全て印字する簡単な例:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mailbox</span>
<span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">mbox</span><span class="p">(</span><span class="s1">&#39;~/mbox&#39;</span><span class="p">):</span>
    <span class="n">subject</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;subject&#39;</span><span class="p">]</span>       <span class="c1"># Could possibly be None.</span>
    <span class="k">if</span> <span class="n">subject</span> <span class="ow">and</span> <span class="s1">&#39;python&#39;</span> <span class="ow">in</span> <span class="n">subject</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">subject</span><span class="p">)</span>
</pre></div>
</div>
<p>Babyl メールボックスから MH メールボックスへ全てのメールをコピーし、変換可能な全ての形式固有の情報を変換する:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mailbox</span>
<span class="n">destination</span> <span class="o">=</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">MH</span><span class="p">(</span><span class="s1">&#39;~/Mail&#39;</span><span class="p">)</span>
<span class="n">destination</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
<span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">Babyl</span><span class="p">(</span><span class="s1">&#39;~/RMAIL&#39;</span><span class="p">):</span>
    <span class="n">destination</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">mailbox</span><span class="o">.</span><span class="n">MHMessage</span><span class="p">(</span><span class="n">message</span><span class="p">))</span>
<span class="n">destination</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
<span class="n">destination</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
</pre></div>
</div>
<p>この例は幾つかのメーリングリストのメールをソートするものです。他のプログラムと平行して変更を加えることでメールが破損したり、プログラムを中断することでメールを失ったり、はたまた半端なメッセージがメールボックス中にあることで途中で終了してしまう、といったことを避けるように注意深く扱っています:</p>
<div class="highlight-python3"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mailbox</span>
<span class="kn">import</span> <span class="nn">email.errors</span>

<span class="n">list_names</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;python-list&#39;</span><span class="p">,</span> <span class="s1">&#39;python-dev&#39;</span><span class="p">,</span> <span class="s1">&#39;python-bugs&#39;</span><span class="p">)</span>

<span class="n">boxes</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">mbox</span><span class="p">(</span><span class="s1">&#39;~/email/</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">list_names</span><span class="p">}</span>
<span class="n">inbox</span> <span class="o">=</span> <span class="n">mailbox</span><span class="o">.</span><span class="n">Maildir</span><span class="p">(</span><span class="s1">&#39;~/Maildir&#39;</span><span class="p">,</span> <span class="n">factory</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">inbox</span><span class="o">.</span><span class="n">iterkeys</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">inbox</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="k">except</span> <span class="n">email</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">MessageParseError</span><span class="p">:</span>
        <span class="k">continue</span>                <span class="c1"># The message is malformed. Just leave it.</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">list_names</span><span class="p">:</span>
        <span class="n">list_id</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="s1">&#39;list-id&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">list_id</span> <span class="ow">and</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">list_id</span><span class="p">:</span>
            <span class="c1"># Get mailbox to use</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">boxes</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

            <span class="c1"># Write copy to disk before removing original.</span>
            <span class="c1"># If there&#39;s a crash, you might duplicate a message, but</span>
            <span class="c1"># that&#39;s better than losing a message completely.</span>
            <span class="n">box</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
            <span class="n">box</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">box</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">box</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>

            <span class="c1"># Remove original message</span>
            <span class="n">inbox</span><span class="o">.</span><span class="n">lock</span><span class="p">()</span>
            <span class="n">inbox</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">inbox</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
            <span class="n">inbox</span><span class="o">.</span><span class="n">unlock</span><span class="p">()</span>
            <span class="k">break</span>               <span class="c1"># Found destination, so stop looking.</span>

<span class="k">for</span> <span class="n">box</span> <span class="ow">in</span> <span class="n">boxes</span><span class="o">.</span><span class="n">itervalues</span><span class="p">():</span>
    <span class="n">box</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">19.4. <code class="docutils literal"><span class="pre">mailbox</span></code> — 様々な形式のメールボックス操作</a><ul>
<li><a class="reference internal" href="#mailbox-objects">19.4.1. <code class="docutils literal"><span class="pre">Mailbox</span></code> オブジェクト</a><ul>
<li><a class="reference internal" href="#maildir">19.4.1.1. <code class="docutils literal"><span class="pre">Maildir</span></code></a></li>
<li><a class="reference internal" href="#mbox">19.4.1.2. <code class="docutils literal"><span class="pre">mbox</span></code></a></li>
<li><a class="reference internal" href="#mh">19.4.1.3. <code class="docutils literal"><span class="pre">MH</span></code></a></li>
<li><a class="reference internal" href="#babyl">19.4.1.4. <code class="docutils literal"><span class="pre">Babyl</span></code></a></li>
<li><a class="reference internal" href="#mmdf">19.4.1.5. <code class="docutils literal"><span class="pre">MMDF</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#message-objects">19.4.2. <code class="docutils literal"><span class="pre">Message</span></code> objects</a><ul>
<li><a class="reference internal" href="#maildirmessage">19.4.2.1. <code class="docutils literal"><span class="pre">MaildirMessage</span></code></a></li>
<li><a class="reference internal" href="#mboxmessage">19.4.2.2. <code class="docutils literal"><span class="pre">mboxMessage</span></code></a></li>
<li><a class="reference internal" href="#mhmessage">19.4.2.3. <code class="docutils literal"><span class="pre">MHMessage</span></code></a></li>
<li><a class="reference internal" href="#babylmessage">19.4.2.4. <code class="docutils literal"><span class="pre">BabylMessage</span></code></a></li>
<li><a class="reference internal" href="#mmdfmessage">19.4.2.5. <code class="docutils literal"><span class="pre">MMDFMessage</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#exceptions">19.4.3. 例外</a></li>
<li><a class="reference internal" href="#examples">19.4.4. 使用例</a></li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="mailcap.html"
                        title="前の章へ">19.3. <code class="docutils literal"><span class="pre">mailcap</span></code> — mailcap ファイルの操作</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="mimetypes.html"
                        title="次の章へ">19.5. <code class="docutils literal"><span class="pre">mimetypes</span></code> — ファイル名を MIME 型へマップする</a></p>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">バグ報告</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/3.6/Doc/library/mailbox.rst"
            rel="nofollow">ソースの表示
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総索引"
             >索引</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> |</li>
        <li class="right" >
          <a href="mimetypes.html" title="19.5. mimetypes — ファイル名を MIME 型へマップする"
             >次へ</a> |</li>
        <li class="right" >
          <a href="mailcap.html" title="19.3. mailcap — mailcap ファイルの操作"
             >前へ</a> |</li>
        <li><img src="../_static/py.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li>
        <li><a href="https://www.python.org/">Python</a> &#187;</li>
        <li>
          <span class="version_switcher_placeholder">3.6.4</span>
          <a href="../index.html">ドキュメント</a> &#187;
        </li>

          <li class="nav-item nav-item-1"><a href="index.html" >Python 標準ライブラリ</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="netdata.html" >19. インターネット上のデータの操作</a> &#187;</li>
    <li class="right">
        

    <div class="inline-search" style="display: none" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
    <script type="text/javascript">$('.inline-search').show(0);</script>
         |
    </li>

      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2001-2018, Python Software Foundation.
    <br />
    Python Software Foundation は非営利団体です。
    <a href="https://www.python.org/psf/donations/">寄付</a>
    <br />
    最終更新日時: 3月 02, 2018
    <a href="../bugs.html">バグを見つけたら</a>?
    <br />
    このドキュメントは <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.6.5 を使って作成されました。
    </div>

  </body>
</html>